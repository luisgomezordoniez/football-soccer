[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "The Beautiful Game",
    "section": "",
    "text": "1 Introduction\nThe history of football dates back to the 19th century, specifically to 1863 with the creation of the Football Association in London, in an effort by English teams to establish clear rules for playing this sport.\n\n\n\n\n\n\nNote\n\n\n\nCreo que no debemos irnos tan atras, tal vez explicar que estamos analizando el futbol inglés porque ahí se creó la primera asociación? Le puse de nombre al proyecto The Beautiful Game, ¿te parece bien conservarlo o tal vez sacar un nombre de la introducción?\n\n\nHowever, the history of football extends much further, as there are records of various ball games in different cultures such as Chinese, Japanese, Greek, and Mesoamerican, dating back thousands of years. Could it be, then, that humans have an inherent need to kick a ball? Kicking may well be an instinct, but it is also true that football satisfies a series of social needs such as tribalism, competition, cooperation, and entertainment.\nIn recent years, the collection of football-related data has multiplied, providing us with the opportunity to analyze football and understand it in depth. As the next World Cup approaches, the need to immerse ourselves in football becomes increasingly present. This is why we decided to conduct an analysis of the most representative aspects of football by choosing one of the most important leagues in the world, the Premier League, as it not only brings together highly talented players but also features a promotion and relegation system that motivates all teams to strive to be part of the select group of the best teams in English football.\nThis project aims to analyze the evolution of the most representative aspects of the English league over the years, in terms of attack and defense. Our hypothesis is that the English football has become more competitive. We will examine this through key match indicatores including goals scored, shots on target, league standings, home versus away performance, refereeing decisions, and card intensity across Premier League matches.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "2  Data",
    "section": "",
    "text": "2.1 Description\nThis project uses publicly available match-level data provided by Football-Data.co.uk, a long-standing repository of standardized football results and match statistics. The platform compiles official match information from multiple reputable sources—including XScores, BBC Sport, Flashscore, and ESPN—and distributes them in a consistent, computer-ready CSV format suitable for statistical analysis.\nFor the purposes of this study, only data from English football competitions were used. These include the Premier League, Championship, League One, League Two, and, when available, the National League. The dataset covers more than two decades of competitive play, with full-time and half-time results available back to the 1993/94 season and detailed match statistics widely available from the 2000/01 season onward.\nThe variables utilized in this project relate exclusively to match outcomes and in-game performance metrics. These include goals scored, half-time results, shots, shots on target, corners, fouls, offsides, disciplinary actions, and referee information. Historical bookmaker odds—also included in the original files—were intentionally excluded, as the analysis focuses on sporting performance rather than betting markets.\nFootball-Data.co.uk aggregates information from multiple official and media-based match reporting services to ensure accuracy and completeness. Data are updated on a rolling basis throughout each season and are archived annually, enabling consistent longitudinal analysis across leagues and time periods.\nThis dataset provides a comprehensive, standardized foundation for evaluating long-term trends in English football, comparing performance across divisions, and studying changes in the nature of the game over time.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#data-collection",
    "href": "data.html#data-collection",
    "title": "2  Data",
    "section": "2.2 Data Collection",
    "text": "2.2 Data Collection\nWe automated the collection and cleaning of match-level data from the Football-Data.co.uk archive. Using tools from the purrr package, it downloads each available season across the four major English divisions, standardizes column naming conventions across years, removes unused or unavailable variables, and consolidates all leagues into a single harmonized dataset. This approach ensures reproducibility, minimizes manual intervention, and guarantees consistency across more than two decades of historical football data.\n\n\nCode\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(readr)\nlibrary(dplyr)\nlibrary(forcats)\nlibrary(ggplot2)\nlibrary(redav)\n\nnot_all_na &lt;- function(x) any(!is.na(x))\nyear_end = 2025\n\nseason_map &lt;- function(start = 1993, end = year_end) {\n  season_year_s &lt;- start:(end - 1)\n  season_year_e &lt;- (start + 1):end\n  \n  tibble(\n    id_season = sprintf(\"%02d%02d\", season_year_s %% 100, season_year_e %% 100),\n    season_name = paste0(season_year_s, \"/\", season_year_e)\n  )\n}\n\nquery &lt;- function(league, start = 1993, end = year_end) {\n  \n  temporadas &lt;- season_map(start, end)\n  \n  keep_cols &lt;- c(\n    \"Div\", \"Date\", \"Time\", \"HomeTeam\", \"AwayTeam\", \"Home\", \"Away\",\n    \"FTHG\", \"FTAG\", \"FTR\", \"HTHG\", \"HTAG\", \"HTR\", \"Referee\",\n    \"HS\", \"AS\", \"HST\", \"AST\", \"HF\", \"AF\", \"HC\", \"AC\",\n    \"HY\", \"AY\", \"HR\", \"AR\"\n  )\n  \n  dfs &lt;- map2(\n    temporadas$id_season,\n    temporadas$season_name,\n    function(id, season) {\n      \n      url &lt;- paste0(\"https://www.football-data.co.uk/mmz4281/\", id, \"/\", league, \".csv\")\n      \n      tryCatch({\n        \n        df &lt;- read_csv(url, show_col_types = FALSE)\n        \n        df &lt;- df %&gt;% \n          select(any_of(keep_cols)) %&gt;% \n          select_if(not_all_na)\n        \n        # fix old Home/Away formats\n        if (\"Home\" %in% names(df)) {\n          df &lt;- df %&gt;% rename(HomeTeam = Home, AwayTeam = Away)\n        }\n        \n        df &lt;- df %&gt;%\n          mutate(Season = season) %&gt;%\n          mutate(across(everything(), as.character))\n        \n        message(\"Loaded season: \", season)\n        df\n        \n      }, error = function(e) {\n        message(\"No data for: \", season)\n        return(NULL)\n      })\n    }\n  )\n  \n  # bind all non-null elements\n  final &lt;- bind_rows(dfs)\n  final=final |&gt; filter(is.na(Div)==F)\n  message(\"Seasons loaded: \", length(unique(final$Season)))\n  message(\"Divisions found: \", paste(unique(final$Div), collapse = \", \"))\n  \n  final\n}\n\n#We save a local copy to avoid unnecesary consults to the repository\n#E0 &lt;- query(\"E0\")   # Premier League | Tier 1\n#E1 &lt;- query(\"E1\")   # Championship | Tier 2\n#E2 &lt;- query(\"E2\")   # League One | Tier 3\n#E3 &lt;- query(\"E3\")   # League Two | Tier 4\n\n#Data_England=bind_rows(E0,E1,E2,E3)\n\nData_England &lt;- read_csv(\"https://github.com/luisgomezordoniez/football-soccer/raw/refs/heads/main/data/Data_England.csv\")\n\nData_England =Data_England |&gt;\n  mutate(\n    League=case_when(\n    Div==\"E0\" ~\"Premier League\",\n    Div==\"E1\" ~\"Championship\",\n    Div==\"E2\" ~\"League One\",\n    Div==\"E3\" ~\"League Two\"))\n\n\n\nData_England$League &lt;- factor(Data_England$League, levels =c(\"Premier League\", \"Championship\",\"League One\", \"League Two\"), ordered = TRUE)\n\nMy_Data_England=Data_England |&gt;\n  group_by(Div, Season) |&gt;\n  summarise(count=n())\n\n\nmy_custom_theme &lt;- function() {\n  theme_classic(base_size = 12) + # Start with a built-in theme as a base\n    theme(\n      plot.title = element_text(size = 14, face = \"bold\"),\n      plot.subtitle = element_text(size = 12, margin = margin(b = 10)),\n      axis.title = element_text(size = 12, face = \"bold\"),\n      axis.text = element_text(size = 10),\n      legend.position = \"right\"\n    )\n}",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#mising-values",
    "href": "data.html#mising-values",
    "title": "2  Data",
    "section": "2.3 Mising Values",
    "text": "2.3 Mising Values\nWe can identify three distinct tiers of data completeness across the four tiers of English football. The pre-2000 era is limited to basic match outcomes and full-time goals. From 2000 onwards, the dataset expands to include granular match statistics, such as shots, corners, fouls, and disciplinary records. Finally, post-2020, data fidelity improves further to include match start times.\n\n\nCode\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(ggalluvial)\nlibrary(lubridate)\nlibrary(GGally)\nlibrary(scales)   # para rescale()\nlibrary(vcd)\n\nmissing_summary &lt;- Data_England %&gt;%\n  group_by(League, Season) %&gt;%\n  summarise(across(everything(), ~100* mean(is.na(.))), .groups = \"drop\") %&gt;%  # proportion missing\n  pivot_longer(\n    cols = -c(League, Season),\n    names_to = \"variable\",\n    values_to = \"prop_missing\"\n  ) %&gt;%\n  group_by(variable) %&gt;%\n  mutate(total_missing = mean(prop_missing, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  mutate(variable = fct_reorder(variable, total_missing, .desc = TRUE))\n\nmissing_summary=missing_summary |&gt;\n  mutate(Season=substr(Season, 6,10))\n\nggplot(missing_summary, aes(x = variable, y = Season, fill = prop_missing)) +\n  geom_tile(color = \"white\") +\n  facet_wrap(~ League, scales = \"free_y\") +\n  scale_fill_gradient(\n    low = \"white\",\n    high = \"#191970\",\n    name = \"Missing (%)\"\n  ) +\n  labs(\n    title = \"Proportion of Missing Values Across Seasons and Columns by League\",\n    x = \"Variable\",\n    y = \"Season\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),\n    panel.spacing = unit(1, \"lines\")\n  )",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#outliers",
    "href": "data.html#outliers",
    "title": "2  Data",
    "section": "2.4 Outliers",
    "text": "2.4 Outliers\nThe heatmap compares how often different outlier-detection methods flag extreme values in each match variable. Across most variables, all three methods identify very few outliers, indicating generally well‑behaved distributions. In contrast, red‑card variables (HR, AR) and, to a lesser extent, full‑time home goals (FTHG) show much higher outlier percentages, especially under the IQR method, revealing heavy tails or rare extreme events, which is reasonable since its not common to have a game with a lot of goals or red cards.\n\n\nCode\noutlier_analysis &lt;- function(df, cols) {\n  results &lt;- list()\n  \n  for (col in cols) {\n    if (!col %in% names(df)) {\n      message(paste(\"Column\", col, \"not found. Skipping.\"))\n      next\n    }\n    \n    x &lt;- df[[col]]\n    x &lt;- x[!is.na(x)]  # remove NAs\n    \n    # Summary stats\n    stats &lt;- summary(x)\n    \n    # ---- Z-score method ----\n    zscores &lt;- (x - mean(x)) / sd(x)\n    z_outliers &lt;- x[abs(zscores) &gt; 3]\n    \n    # ---- IQR method ----\n    Q1 &lt;- quantile(x, 0.25)\n    Q3 &lt;- quantile(x, 0.75)\n    IQR_val &lt;- Q3 - Q1\n    lower_iqr &lt;- Q1 - 1.5 * IQR_val\n    upper_iqr &lt;- Q3 + 1.5 * IQR_val\n    iqr_outliers &lt;- x[x &lt; lower_iqr | x &gt; upper_iqr]\n    \n    # ---- Percentile method ----\n    p1  &lt;- quantile(x, 0.01)\n    p99 &lt;- quantile(x, 0.99)\n    pct_outliers &lt;- x[x &lt; p1 | x &gt; p99]\n    \n    results[[col]] &lt;- list(\n      summary_stats = stats,\n      zscore_outliers = z_outliers,\n      z_outlier_pct = length(z_outliers) / length(x) * 100,\n      iqr_outliers = iqr_outliers,\n      iqr_outlier_pct = length(iqr_outliers) / length(x) * 100,\n      percentile_outliers = pct_outliers,\n      pct_outlier_pct = length(pct_outliers) / length(x) * 100\n    )\n  }\n  \n  return(results)\n}\n\ncolumns_to_check &lt;- c(\n  \"FTHG\",\"FTAG\",      # goals\n  \"HTHG\",\"HTAG\",      # goals\n  \"HS\",\"AS\",          # shots\n  \"HST\",\"AST\",        # shots on target\n  \"HF\",\"AF\",          # fouls\n  \"HC\",\"AC\",          # corners\n  \"HY\",\"AY\",          # yellow cards\n  \"HR\",\"AR\"           # red cards\n)\n\noutliers &lt;- outlier_analysis(Data_England, columns_to_check)\n\n\n\nplot_outlier_heatmap &lt;- function(outlier_list) {\n  tibble(\n    variable = names(outlier_list),\n    zscore_pct   = sapply(outlier_list, function(x) x$z_outlier_pct),\n    iqr_pct      = sapply(outlier_list, function(x) x$iqr_outlier_pct),\n    percentile_pct = sapply(outlier_list, function(x) x$pct_outlier_pct)\n  ) %&gt;%\n    pivot_longer(cols = -variable, names_to = \"method\", values_to = \"pct\") %&gt;%\n    ggplot(aes(x = method, y = variable, fill = pct)) +\n    geom_tile() +\n    scale_fill_gradient(low = \"white\", high = \"red\") +\n    theme_minimal(base_size = 13) +\n    labs(\n      title = \"Outlier Percentage by Method\",\n      x = \"Method\",\n      y = \"Variable\",\n      fill = \"% Outliers\"\n    )\n}\n\nplot_outlier_heatmap(outliers)\n\n\n\n\n\n\n\n\n\nFor example, the outliers in home‑team goals per match (FTHG) and in red cards for both home (HR) and away teams (AR) are concentrated near the upper quantiles of their respective distributions.\n\n\nCode\nplot_density_outliers &lt;- function(df, col) {\n  x &lt;- df[[col]]\n  x &lt;- x[!is.na(x)]\n  \n  p1  &lt;- quantile(x, 0.05)\n  p99 &lt;- quantile(x, 0.95)\n  \n  tibble(value = x) %&gt;%\n    ggplot(aes(value)) +\n    geom_bar(fill = \"steelblue\", alpha = 0.75) +\n    geom_vline(xintercept = p1,  color = \"red\", linetype = \"dashed\") +\n    geom_vline(xintercept = p99, color = \"red\", linetype = \"dashed\") +\n    scale_x_continuous(breaks = seq(0, 9, by = 1))+\n    theme_minimal(base_size = 13) +\n    labs(\n      title = paste(\"Distribution of\", col),\n      subtitle = \"Red dashed lines = 5th & 95th percentiles\",\n      x = col,\n      y = \"Number of games\"\n    )\n}\n\nplot_density_outliers(Data_England, \"FTHG\")\n\n\n\n\n\n\n\n\n\nCode\nplot_density_outliers(Data_England, \"HR\")\n\n\n\n\n\n\n\n\n\nCode\nplot_density_outliers(Data_England, \"AR\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote about variable names\n\n\n\n\n\nThe column names of our dataset are not very informative. We decided to include them here in case the description is useful.\n\nDiv = League Division\nDate = Match Date (dd/mm/yy)\nTime = Time of match kick off\nHomeTeam = Home Team\nAwayTeam = Away Team\nFTHG and HG = Full Time Home Team Goals\nFTAG and AG = Full Time Away Team Goals\nFTR and Res = Full Time Result (H=Home Win, D=Draw, A=Away Win)\nHTHG = Half Time Home Team Goals\nHTAG = Half Time Away Team Goals\nHTR = Half Time Result (H=Home Win, D=Draw, A=Away Win)\nReferee = Match Referee\nHS = Home Team Shots\nAS = Away Team Shots\nHST = Home Team Shots on Target\nAST = Away Team Shots on Target\nHF = Home Team Fouls Committed\nAF = Away Team Fouls Committed\nHY = Home Team Yellow Cards\nAY = Away Team Yellow Cards\nHR = Home Team Red Cards\nAR = Away Team Red Cards",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "results.html",
    "href": "results.html",
    "title": "3  Results",
    "section": "",
    "text": "3.1 Home Advantage\nWe want to see how soccer has changed through the years in terms of attack and defense. Our hypothesis is that the english football has become more competitive. For proving this hypothesis we will analyze the differences among the teams that conform the Premier League and the lower tiers, the dominance and the results of the matches.\nFirst of all, we know that goals can be a strong indicator to understand this, so we plan to base our first analysis on the average number of goals scored by teams.\nCode\nlibrary(dplyr)\nlibrary(lubridate)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\nlibrary(rnaturalearth)\nlibrary(rnaturalearthhires)\nlibrary(sf)\nlibrary(ggrepel)\nlibrary(readr)\nlibrary(forcats)\nlibrary(FactoMineR)\nlibrary(factoextra)\nlibrary(plotly)\nlibrary(tidyr)\nlibrary(ggalluvial)\nlibrary(GGally)\nlibrary(scales)\nlibrary(vcd)\n\n\nData_England &lt;- read_csv(\"https://github.com/luisgomezordoniez/football-soccer/raw/refs/heads/main/data/Data_England.csv\")\n\nData_England =Data_England |&gt;\n  mutate(\n    League=case_when(\n    Div==\"E0\" ~\"Premier League\",\n    Div==\"E1\" ~\"Championship\",\n    Div==\"E2\" ~\"League One\",\n    Div==\"E3\" ~\"League Two\"))\n\n\n#summary(Data_England)\n\nData_England$League &lt;- factor(Data_England$League, levels =c(\"Premier League\", \"Championship\",\"League One\", \"League Two\"), ordered = TRUE)\n\nmy_custom_theme &lt;- function() {\n  theme_classic(base_size = 12) + # Start with a built-in theme as a base\n    theme(\n      plot.title = element_text(size = 14, face = \"bold\"),\n      plot.subtitle = element_text(size = 12, margin = margin(b = 10)),\n      axis.title = element_text(size = 12, face = \"bold\"),\n      axis.text = element_text(size = 10),\n      legend.position = \"right\"\n    )\n}\n\nData_England$Year=as.numeric(substr(Data_England$Date,6,9))\nCode\n# Average goals through the years, by local and away.\n# Cleveland plots for the average goals by league through the years.\n\n\npremier_full &lt;- Data_England |&gt;\n  filter(Div == \"E0\")\n\n#dim(premier_full)\n\n#premier_full |&gt;\n#  select(Season, Date, HomeTeam, AwayTeam, FTHG, FTAG) |&gt;\n#  head(20)\n\n#premier_full |&gt;\n#  count(Season) |&gt;\n#  arrange(Season) |&gt;\n#  print(n = Inf)\n\n\n\n\npremier_full &lt;- premier_full |&gt;\n  mutate(Date = dmy(Date))\n\n#premier_full |&gt;\n#  select(Season, Date, HomeTeam, AwayTeam) |&gt;\n#  head(10)\n\n#summary(premier_full$Date)\n\npremier_full &lt;- premier_full |&gt;\n  mutate(Year = year(Date))\n\n#premier_full |&gt;\n#  select(Season, Date, Year, HomeTeam, AwayTeam) |&gt;\n#  head(12)\n\n#premier_full |&gt;\n#  count(Year) |&gt;\n#  arrange(Year) |&gt;\n#  print(n = Inf)\n\npremier_full &lt;- premier_full |&gt;\n  mutate(TotalGoals = FTHG + FTAG)\n\n#premier_full |&gt;\n#  select(Season, Date, HomeTeam, AwayTeam,\n#         FTHG, FTAG, TotalGoals) |&gt;\n#  head(10)\n\n#summary(premier_full$TotalGoals)\n\npremier_full &lt;- premier_full |&gt;\n  group_by(Season) |&gt;\n  filter(n() == 380) |&gt;\n  ungroup()\n\n#premier_full |&gt;\n#  count(Season) |&gt;\n#  arrange(Season)\n\npremier_goals &lt;- premier_full |&gt;\n  select(Season, Year, HomeTeam, AwayTeam,\n         FTHG, FTAG, TotalGoals)\n\n#head(premier_goals)\n#summary(premier_goals)\n\npremier_goals_yearly &lt;- premier_goals |&gt;\n  group_by(Year) |&gt;\n  summarise(\n    avg_home_goals  = mean(FTHG, na.rm = TRUE),\n    avg_away_goals  = mean(FTAG, na.rm = TRUE),\n    avg_total_goals = mean(TotalGoals, na.rm = TRUE)\n  )\n\n#premier_goals_yearly |&gt;\n#  head(15)\n\n#premier_goals_yearly |&gt;\n#  tail(10)\n\n#summary(premier_goals_yearly)\n\n\npremier_goals_yearly |&gt;\n  ggplot(aes(x = Year)) +\n  geom_line(aes(y = avg_home_goals, color = \"Home\"), linewidth = 1) +\n  geom_point(aes(y = avg_home_goals, color = \"Home\"), size = 2) +\n  geom_line(aes(y = avg_away_goals, color = \"Away\"), linewidth = 1) +\n  geom_point(aes(y = avg_away_goals, color = \"Away\"), size = 2) +\n  scale_color_manual(values = c(\"Home\" = \"#1f77b4\", \"Away\" = \"#d62728\")) +\n  labs(\n    title = \"Average Home and Away Goals per Season — Premier League\",\n    x = \"Year\",\n    y = \"Average Goals per Match\",\n    color = \"Team\"\n  ) +\n  my_custom_theme()+\n  theme(\n    legend.position = \"bottom\"\n  )\nWhile the average number of goals by home teams has remained relatively stable since 1993, away teams show a clear upward trend in goals, reflecting more offensive strategies, especially since 2015. This suggests a reduction in the traditional home-field advantage.\nBetween 1993 and 2010, away teams scored about 1.10-1.15 goals per match, but since 2011 this number has increased to around 1.20-1.25. Starting in 2018, we can observe a sustained raise in away goals, reaching historic highs in 2023 and 2024, when they exceeded 1.45 goals per match.\nHome teams have consistently scored between 1.45 and 1.65 goals per match throughout the entire period, with small drops in 2008 and 2015. Recently, in 2023, there was an increase, but not one strong enough to confirm an upward trend.\nHome-field advantage has decreased significantly over the years. The recent offensive surge in the Premier League comes mainly from away teams.\nCode\npremier_full_complete &lt;- premier_full |&gt;\n  group_by(Season) |&gt;\n  filter(n() == 380) |&gt;\n  ungroup()\n\n# Proportion of results: H, A, D\nresults_yearly &lt;- premier_full_complete |&gt;\n  group_by(Year, FTR) |&gt;\n  summarise(n = n(), .groups = \"drop\") |&gt;\n  group_by(Year) |&gt;\n  mutate(prop = n / sum(n)) |&gt;\n  ungroup()\n\n# Proportion of Match Results per Season — Premier League\nresults_yearly |&gt;\n  ggplot(aes(x = Year, y = prop, color = FTR)) +\n  geom_line(linewidth = 1.2) +  \n  scale_color_brewer(\n    palette = \"Set2\",                \n    labels = c(\"H\" = \"Home win\",\n               \"D\" = \"Draw\",\n               \"A\" = \"Away win\"),\n    name = \"Result\"\n  ) +\n  labs(\n    title = \"Proportion of Match Results per Season — Premier League\",\n    subtitle = \"Only complete seasons (380 matches per season)\",\n    x = \"Year\",\n    y = \"Proportion of Matches\"\n  ) +\n  my_custom_theme()+\n  theme(\n    legend.position = \"bottom\"\n  )\nOver the past three decades, Premier League results show a decrease in draws, an increase in away-team victories, and relatively stable home-team victories. This suggests that the league has become more competitive and that the traditional home-field advantage has gradually diminished.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "results.html#seasonal-trends",
    "href": "results.html#seasonal-trends",
    "title": "3  Results",
    "section": "3.2 Seasonal trends",
    "text": "3.2 Seasonal trends\n\n\nCode\nlibrary(tidyverse)\nlibrary(lubridate)\nSeasons=c(\"2000/2001\", \"2004/2005\", \"2009/2010\", \"2014/2015\", \"2019/2020\", \"2023/2024\")\n# 1. Prepare Data\ngoals_monthly &lt;- Data_England |&gt;\n  filter(Season %in% Seasons & Div==\"E0\") |&gt;\n  mutate(MatchDate = lubridate::dmy(Date),                # Convert string to Date\n         Month = lubridate::month(MatchDate, label = TRUE, abbr = TRUE)) |&gt;\n  # Filter out rare off-season games (June/July)\n  filter(!Month %in% c(\"Jun\", \"Jul\")) |&gt;\n  # Reorder months to follow the Football Season (Aug -&gt; May)\n  mutate(Month = factor(Month, levels = c(\"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\", \n                                          \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\"))) |&gt;\n  group_by(Month, Season) |&gt;\n  summarise(AvgGoals = mean(FTHG + FTAG, na.rm = TRUE), .groups = \"drop\")\n\n# 2. Plot\nggplot(goals_monthly, aes(x = Month, y = AvgGoals, group = Season, color = Season)) +\n  geom_line(size = 1.2) +\n  geom_point(size = 3) +\n  labs(\n    title = \"End of Season Madness?\",\n    subtitle = \"Average Goals per Game by Month\",\n    y = \"Avg Total Goals\",\n    x = \"Month of Season\") + my_custom_theme()\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Alluvial of the standigns of each league over the last years.\n\n\ntarget_season &lt;- \"2023/2024\"\n\nprem_season &lt;- premier_full_complete |&gt;\n  filter(Season == target_season)\n\nprem_season &lt;- prem_season |&gt;\n  mutate(Date = as.Date(Date))\n\nresults_long &lt;- bind_rows(\n  prem_season |&gt;\n    transmute(\n      Date,\n      Team = HomeTeam,\n      Opp  = AwayTeam,\n      GF   = FTHG,\n      GA   = FTAG\n    ),\n  prem_season |&gt;\n    transmute(\n      Date,\n      Team = AwayTeam,\n      Opp  = HomeTeam,\n      GF   = FTAG,\n      GA   = FTHG\n    )\n) |&gt;\n  arrange(Date, Team) |&gt;\n  mutate(\n    Points = case_when(\n      GF &gt; GA ~ 3L,\n      GF == GA ~ 1L,\n      TRUE    ~ 0L\n    ),\n    GD = GF - GA\n  )\n\nresults_cum &lt;- results_long |&gt;\n  group_by(Team) |&gt;\n  arrange(Date, .by_group = TRUE) |&gt;\n  mutate(\n    game_number = row_number(),       \n    cum_pts     = cumsum(Points),\n    cum_gd      = cumsum(GD),\n    cum_gf      = cumsum(GF)\n  ) |&gt;\n  ungroup()\n\n# Ranking after each game week\nstandings_by_round &lt;- results_cum |&gt;\n  group_by(game_number) |&gt;\n  arrange(\n    desc(cum_pts),\n    desc(cum_gd),\n    desc(cum_gf),\n    Team,\n    .by_group = TRUE\n  ) |&gt;\n  mutate(Position = row_number()) |&gt;\n  ungroup()\n\nmax_round &lt;- max(standings_by_round$game_number, na.rm = TRUE)\ncuts &lt;- sort(unique(c(1, seq(3, max_round, by = 3), max_round)))\n\nalluvial_df &lt;- standings_by_round |&gt;\n  filter(game_number %in% cuts) |&gt;\n  mutate(\n    Matchday  = factor(game_number, levels = cuts),\n    PosFactor = factor(Position, levels = 1:20)\n  )\n\nggplot(alluvial_df, aes(x = Matchday, stratum  = PosFactor, alluvium = Team, y= 1,\n      fill     = Team)) +\n  geom_flow(stat= \"alluvium\", lode.guidance = \"frontback\", alpha= 0.65) +\n  geom_stratum(width = 0.25, color = \"grey30\") +\n  stat_stratum(geom  = \"text\", aes(label = after_stat(stratum)),size  = 3,color = \"black\") +\n  guides(fill = \"none\") +  \n  geom_text(\n    stat = \"alluvium\",\n    data = dplyr::filter(\n      alluvial_df,\n      Matchday == levels(Matchday)[length(levels(Matchday))]),\n    aes(label = Team),\n    size      = 3,\n    color     = \"black\",\n    hjust     = -0.05,\n    position  = position_nudge(x = 0.2)\n  ) +\n  scale_x_discrete(expand = expansion(mult = c(0.02, 0.20))) +\n  labs(\n    title    = \"Team Positions Over the Season (Alluvial)\",\n    subtitle = paste(\n      \"Premier League\", target_season,\n      \"— positions shown every 5 matchdays\"\n    ),\n    x        = \"Matchday\",\n    y        = \"Position\",\n    caption  = \"Source: football-data.co.uk | EDAV Final Project\"\n  ) +\n   my_custom_theme()+\n  theme(\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor   = element_blank()\n  )\n\n\n\n\n\n\n\n\n\nThe Premier League is considered an extremely competitive league due to its more equitable distribution of broadcasting revenue, te quality of signings, and the high athletic level of the playeres. Nevertheless, if we look at last season´s table, we can identify three types of teams: those that fight for the top positions, those that remain in the middle of the table, and those that struggle to avoid finishing last. The first ten matches of the 2024 were not definite to predict how the teams would end the season were not enough to predict how the teams would finish; after the tenth match, the die was pretty much cast, and the battle unfolded within each of these three groups.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "results.html#team-performance-by-league-over-the-years",
    "href": "results.html#team-performance-by-league-over-the-years",
    "title": "3  Results",
    "section": "3.3 Team performance by league over the years",
    "text": "3.3 Team performance by league over the years\n\n\nCode\ncalculate_points &lt;- function(full_time_result, is_home_team) {\n  case_when(\n    full_time_result == \"H\" & is_home_team ~ 3,\n    full_time_result == \"A\" & !is_home_team ~ 3,\n    full_time_result == \"D\" ~ 1,\n    TRUE ~ 0\n  )\n}\n\n\n# 2. CALCULATE LEAGUE STANDINGS\n# Home results\nhome_results &lt;- Data_England |&gt;\n  select(Season, Div, HomeTeam, FTHG, FTAG, FTR,Tier) |&gt;\n  rename(Team = HomeTeam, GoalsFor = FTHG, GoalsAgainst = FTAG) |&gt;\n  mutate(\n    Points = calculate_points(FTR, TRUE),\n    Venue = \"Home\"\n  )\n\n# Away results\naway_results &lt;- Data_England |&gt;\n  select(Season, Div, AwayTeam, FTHG, FTAG, FTR,Tier) |&gt;\n  rename(Team = AwayTeam, GoalsFor = FTAG, GoalsAgainst = FTHG) |&gt;\n  mutate(\n    Points = calculate_points(FTR, FALSE),\n    Venue = \"Away\"\n  )\n\n# Combine and calculate standings\nall_results &lt;- bind_rows(home_results, away_results)\n\nseason_standings &lt;- all_results |&gt;\n  group_by(Season, Div, Team,Tier) |&gt;\n  summarise(\n    Played = n(),\n    Wins = sum(Points == 3),\n    Draws = sum(Points == 1),\n    Losses = sum(Points == 0),\n    GoalsFor = sum(GoalsFor),\n    GoalsAgainst = sum(GoalsAgainst),\n    GoalDifference = GoalsFor - GoalsAgainst,\n    Points = sum(Points),\n    .groups = 'drop'\n  ) |&gt;\n  group_by(Season, Div) |&gt;\n  mutate(\n    Position = rank(desc(Points), ties.method = \"first\")\n  ) |&gt;\n  arrange(Season, Div, Position)\n\n\ntitles_data=season_standings |&gt;\n  filter(Div==\"E0\" &Position==1) |&gt;\n  group_by(Team) |&gt;\n  summarise(Titles=n())\n\n# Merge titles data with seasons data\n\n# Create the plot with highlighted Tier 1 teams\n\nmost_recent_season &lt;- max(Data_England$Season, na.rm = TRUE)\ncurrent_tier1_teams &lt;- Data_England |&gt;\n  filter(Div == \"E0\" & Season == most_recent_season) |&gt;\n  distinct(HomeTeam) |&gt;\n  pull(HomeTeam)\n\nData_Teams &lt;- Data_England |&gt;\n  filter(Div == \"E0\") |&gt;\n  group_by(HomeTeam) |&gt;\n  summarize(Seasons = n_distinct(Season)) |&gt;\n  mutate(\n    # Identify if team is currently in Tier 1\n    Current_Tier1 = HomeTeam %in% current_tier1_teams,\n    # Create fill color based on Tier 1 status\n    Team_Type = ifelse(Current_Tier1, \"Current Tier 1\", \"Other Teams\")\n  )\n\n\nData_Teams_Enhanced &lt;- Data_Teams |&gt;\n  left_join(titles_data, by = c(\"HomeTeam\" = \"Team\")) |&gt;\n  mutate(\n    Titles = replace_na(Titles, 0),\n    Current_Tier1 = HomeTeam %in% current_tier1_teams,\n    Team_Type = ifelse(Current_Tier1, \"Premier League\", \"Lower Tiers\")\n  )\n\n\n# Plot with titles in labels\nData_Teams_Enhanced |&gt;\n  mutate(HomeTeam = fct_reorder(HomeTeam, Seasons)) |&gt;\n  ggplot(aes(x = HomeTeam, y = Seasons, fill = Team_Type)) +\n  geom_col() +\n  geom_col(aes(x = HomeTeam, y = Titles),fill=\"gold3\")+\n  geom_text(aes(label = ifelse(Titles &gt; 0, \n                               paste0(\"Titles: \", Titles),\"\"\n  )),\n  # y = 0.5,  # Position at the start of the bar\n  hjust = 0, size = 3.5, color = \"black\",fontface = \"bold\") +\n  coord_flip() +\n  labs(\n    title = \"Premier League Seasons and Titles\",\n    x = \"Team\",\n    y = \"Seasons\",\n    fill = \"\",\n    caption=\"\"\n  ) +\n  scale_fill_manual(\n    values = c(\"Premier League\" = \"steelblue\", \"Lower Tiers\" = \"lightsteelblue\")\n  ) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +\n  my_custom_theme()+\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Teams in the last season, where were they in the last seasons?\n\n\n## Definition of standings_final\nseason_sizes &lt;- premier_full |&gt;\n  count(Season, name = \"n_matches\")\n\ncomplete_seasons &lt;- season_sizes |&gt;\n  filter(n_matches == 380) |&gt;\n  pull(Season)\n\npremier_complete &lt;- premier_full |&gt;\n  filter(Season %in% complete_seasons)\n\nseasons_sel &lt;- c(\"2000/2001\", \"2005/2006\", \"2010/2011\",\n                 \"2015/2016\", \"2020/2021\", \"2023/2024\")\n\npremier_sel &lt;- premier_complete |&gt;\n  filter(Season %in% seasons_sel)\n\nresults_long &lt;- bind_rows(\n  premier_sel |&gt;\n    transmute(Season,\n              Team = HomeTeam,\n              GF = FTHG,\n              GA = FTAG),\n  premier_sel |&gt;\n    transmute(Season,\n              Team = AwayTeam,\n              GF = FTAG,\n              GA = FTHG)\n) |&gt;\n  mutate(\n    Points = case_when(\n      GF &gt; GA ~ 3L,\n      GF == GA ~ 1L,\n      TRUE    ~ 0L\n    ),\n    GD = GF - GA\n  )\n\nstandings_final &lt;- results_long |&gt;\n  group_by(Season, Team) |&gt;\n  summarise(\n    points = sum(Points, na.rm = TRUE),\n    gd     = sum(GD,     na.rm = TRUE),\n    gf     = sum(GF,     na.rm = TRUE),\n    .groups = \"drop\"\n  ) |&gt;\n  group_by(Season) |&gt;\n  arrange(Season,\n          desc(points), desc(gd), desc(gf), Team,\n          .by_group = TRUE) |&gt;\n  mutate(Position = row_number()) |&gt;\n  ungroup()\n\nteams_first_season &lt;- standings_final |&gt;\n  filter(Season == \"2000/2001\") |&gt;\n  pull(Team)\n\nstandings_first &lt;- standings_final |&gt;\n  filter(Team %in% teams_first_season) |&gt;\n  mutate(\n    Season = factor(Season, levels = seasons_sel),\n    PosFactor = factor(Position, levels = 20:1)\n  )\n\nggplot(\n  standings_first,\n  aes(x = Season,\n      stratum  = PosFactor,\n      alluvium = Team,\n      y        = 1,\n      fill     = Team)\n) +\n  geom_flow(stat = \"alluvium\",\n            lode.guidance = \"frontback\",\n            alpha = 0.65) +\n  geom_stratum(width = 0.25, color = \"grey30\") +\n  stat_stratum(geom = \"text\",\n               aes(label = after_stat(stratum)),\n               size = 3, color = \"black\") +\n  guides(fill = \"none\") +\n  geom_text(\n    stat = \"alluvium\",\n    data = standings_first |&gt;\n      filter(Season == seasons_sel[1]),\n    aes(label = Team),\n    size = 3, color = \"black\", hjust = 1.05,\n    position = position_nudge(x = -0.2)\n  ) +\n  scale_x_discrete(expand = expansion(mult = c(0.20, 0.02))) +\n  scale_y_reverse(breaks = NULL) +\n  labs(\n    title    = \"Evolution of 2000/2001 Teams\",\n    subtitle = \"Premier League — Where did the early 2000s teams end up?\",\n    x        = \"Season\",\n    y        = NULL,\n    caption  = \"Source: football-data.co.uk | EDAV Final Project\"\n  ) +\n  my_custom_theme()\n\n\n\n\n\n\n\n\n\nIf we go back 25 years and look at the Premier League standings for the 2000-2001 season, we can clearly see more competitiveness than by analyzing just one season. Of the twenty teams that played in the Premier League twenty-five years ago, only ten remain in the league for the 2023-2024 season. Among them, there are teams like Arsenal, Liverpool, and Chelsea, which have maintained a relatively similar position from 2000 to today; teams like Aston Villa and Tottenham, which climbed in the standings over the years, moving from the eighth and twelfth to fourth and ninth, respectively; and teams that have changed dramatically, such as Manchester United, which held first place in 2000-2001 and is now in eighth, or Manchester City, which was in eighteenth place in 2000-2001 and is now in first place.\n\n\nCode\n# Teams in the season 2023/2024: where were they in the season 2000-2001?\n\nteams_last_season &lt;- standings_final |&gt;\n  filter(Season == \"2023/2024\") |&gt; \n  pull(Team)\n\nstandings_last &lt;- standings_final |&gt;\n  filter(Team %in% teams_last_season) |&gt;\n  mutate(\n    Season = factor(Season, levels = seasons_sel),\n    PosFactor = factor(Position, levels = 20:1)\n  )\n\nggplot(\n  standings_last,\n  aes(x = Season,\n      stratum  = PosFactor,\n      alluvium = Team,\n      y        = 1,\n      fill     = Team)\n) +\n  geom_flow(stat = \"alluvium\",\n            lode.guidance = \"frontback\",\n            alpha = 0.65) +\n  geom_stratum(width = 0.25, color = \"grey30\") +\n  stat_stratum(geom = \"text\",\n               aes(label = after_stat(stratum)),\n               size = 3, color = \"black\") +\n  guides(fill = \"none\") +\n  # Etiquetas en la ÚLTIMA temporada (lado derecho)\n  geom_text(\n    stat = \"alluvium\",\n    data = standings_last |&gt;\n      filter(Season == seasons_sel[length(seasons_sel)]),\n    aes(label = Team),\n    size = 3, color = \"black\", hjust = -0.05, \n    position = position_nudge(x = 0.2)  \n  ) +\n  scale_x_discrete(expand = expansion(mult = c(0.02, 0.20))) +\n  scale_y_reverse(breaks = NULL) +\n  labs(\n    title    = \"Evolution of 2023/2024 Teams\",\n    subtitle = \"Premier League — Where did today's teams come from?\",\n    x        = \"Season\",\n    y        = NULL,\n    caption  = \"Source: football-data.co.uk | EDAV Final Project\"\n  ) + my_custom_theme()\n\n\n\n\n\n\n\n\n\nWhen we analyze the teams in the current season and compare their historical positions, we can confirm the behavior observed in the previous plot. We also we see that all the teams ranked from tenth place downward were not competing in the Premier League twenty-five years ago. Most of them were already in the league five years ago, but some were not consistently present before and have only recently been promoted to the Premier League, such as Bournemouth, Brentford, Nottingham Forest, and Luton.\nThis is a positive sign the league’s competitiveness as it indicates that newly promoted teams can enter the Premier League and compete with the top clubs.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "results.html#the-english-football-system",
    "href": "results.html#the-english-football-system",
    "title": "3  Results",
    "section": "3.4 The English Football System",
    "text": "3.4 The English Football System\n\n3.4.1 Locations\nWe have 116 teams across all the tiers, we can see that London and\n\n\nCode\n{\n  stadiums &lt;- data.frame(\n  team = c(\n    \"Arsenal\",\"Aston Villa\",\"Bournemouth\",\"Brentford\",\"Brighton\",\"Burnley\",\n    \"Chelsea\",\"Crystal Palace\",\"Everton\",\"Fulham\",\"Leeds\",\"Leicester\",\n    \"Liverpool\",\"Luton\",\"Man City\",\"Man United\",\"Newcastle\",\"Nott'm Forest\",\n    \"Sheffield United\",\"Southampton\",\"Sunderland\",\"Tottenham\",\"West Ham\",\n    \"Wolves\",\"Cardiff\",\"Swansea\",\"Stoke\",\"Norwich\",\"West Brom\",\"Huddersfield\",\n    \"QPR\",\"Reading\",\"Wigan\",\"Blackburn\",\"Bolton\",\"Birmingham\",\"Portsmouth\",\n    \"Blackpool\",\"Derby\",\"Grimsby\",\"Stockport\",\"Tranmere\",\"Port Vale\",\"Bury\",\n    \"Rushden & D\",\"Hartlepool\",\"Dag and Red\",\"Hereford\",\"Torquay\",\"Boston\",\n    \"Kidderminster\",\"Scarborough\",\"Ipswich\",\"Middlesbrough\",\"Watford\",\"Hull\",\n    \"Coventry\",\"Charlton\",\"Sheffield Weds\",\"Wimbledon\",\"Barnsley\",\"Oldham\",\n    \"Swindon\",\"Oxford\",\"Wrexham\",\"Bristol City\",\"Millwall\",\"Preston\",\n    \"Plymouth\",\"Rotherham\",\"Peterboro\",\"Wycombe\",\"Burton\",\"Milton Keynes Dons\",\n    \"Doncaster\",\"Bristol Rvs\",\"Shrewsbury\",\"Cambridge\",\"Carlisle\",\"Cheltenham\",\n    \"Fleetwood Town\",\"Accrington\",\"Morecambe\",\"Forest Green\",\"Chesterfield\",\n    \"Leyton Orient\",\"Newport County\",\"Barrow\",\"Sutton\",\"Yeovil\",\"Scunthorpe\",\n    \"Colchester\",\"Southend\",\"Gillingham\",\"Walsall\",\"Notts County\",\"Lincoln\",\n    \"Exeter\",\"Northampton\",\"Macclesfield\",\"York\",\"Barnet\",\"Salford\",\n    \"Harrogate\",\"Darlington\",\"Halifax\"\n  ),\n  stadium = c(\n    \"Emirates Stadium\",\"Villa Park\",\"Vitality Stadium\",\"Gtech Community Stadium\",\n    \"Falmer Stadium (AMEX)\",\"Turf Moor\",\"Stamford Bridge\",\"Selhurst Park\",\n    \"Goodison Park\",\"Craven Cottage\",\"Elland Road\",\n    \"King Power Stadium\",\"Anfield\",\"Kenilworth Road\",\"Etihad Stadium\",\n    \"Old Trafford\",\"St James' Park\",\"The City Ground\",\"Bramall Lane\",\n    \"St Mary's Stadium\",\"Stadium of Light\",\"Tottenham Hotspur Stadium\",\n    \"London Stadium\",\"Molineux Stadium\",\"Cardiff City Stadium\",\n    \"Swansea.com Stadium\",\"Bet365 Stadium\",\"Carrow Road\",\"The Hawthorns\",\n    \"John Smith's Stadium\",\"Loftus Road\",\"Select Car Leasing Stadium\",\n    \"DW Stadium\",\"Ewood Park\",\"Toughsheet Community Stadium\",\"St Andrew's\",\n    \"Fratton Park\",\"Bloomfield Road\",\"Pride Park Stadium\",\"Blundell Park\",\n    \"Edgeley Park\",\"Prenton Park\",\"Vale Park\",\"Gigg Lane\",\n    \"Hayden Road\",\"Victoria Park\",\"Victoria Road\",\"Edgar Street\",\n    \"Plainmoor\",\"York Street\",\"Aggborough\",\"McCain Stadium\",\n    \"Portman Road\",\"Riverside Stadium\",\"Vicarage Road\",\"MKM Stadium\",\n    \"Coventry Building Society Arena\",\"The Valley\",\"Hillsborough\",\n    \"Plough Lane\",\"Oakwell\",\"Boundary Park\",\"County Ground\",\n    \"Kassam Stadium\",\"Racecourse Ground\",\"Ashton Gate\",\"The Den\",\"Deepdale\",\n    \"Home Park\",\"New York Stadium\",\"London Road Stadium\",\n    \"Adams Park\",\"Pirelli Stadium\",\"Stadium MK\",\"Keepmoat Stadium\",\n    \"Memorial Stadium\",\"Montgomery Waters Meadow\",\"Abbey Stadium\",\n    \"Brunton Park\",\"Whaddon Road\",\"Highbury Stadium\",\"Crown Ground\",\n    \"Mazuma Mobile Stadium\",\"The New Lawn\",\"Technique Stadium\",\"Brisbane Road\",\n    \"Rodney Parade\",\"Holker Street\",\"Gander Green Lane\",\"Huish Park\",\n    \"Glanford Park\",\"JobServe Community Stadium\",\"Roots Hall\",\n    \"Priestfield Stadium\",\"Bescot Stadium\",\"Meadow Lane\",\"Sincil Bank\",\n    \"St James Park\",\"Sixfields Stadium\",\"Moss Rose\",\"Bootham Crescent\",\n    \"The Hive Stadium\",\"Peninsula Stadium\",\"Wetherby Road\",\"Blackwell Meadows\",\n    \"The Shay\"\n  ),\n  lat = c(\n    51.5548,52.5091,50.7352,51.4909,50.8617,53.7891,\n    51.4817,51.3983,53.4387,51.4749,53.7788,52.6201,\n    53.4308,51.8841,53.4830,53.4631,54.9756,52.9392,\n    53.3703,50.9080,54.9144,51.6033,51.5387,52.5901,\n    51.4705,51.6429,52.9881,52.6226,52.5090,53.6499,\n    51.5093,51.4223,53.5463,53.7287,53.5807,52.4759,\n    50.7930,53.8055,52.9225,53.5683,53.4087,53.3779,\n    53.0335,53.5939,52.3338,54.6853,51.5593,52.0649,\n    50.4746,52.9691,52.3800,54.2770,52.0553,54.5828,\n    51.6501,53.7469,52.4497,51.4862,53.4283,51.4287,\n    53.5522,53.5517,51.5647,51.7166,53.0519,51.4402,\n    51.4851,53.7719,50.3804,53.4289,52.5646,51.6210,\n    52.8124,52.0084,53.5186,51.4854,52.6938,52.2039,\n    54.8931,51.9056,53.9248,53.7431,54.0723,51.6427,\n    53.2423,51.5583,51.5873,54.1202,51.3653,50.9328,\n    53.5850,51.9213,51.5458,51.3857,52.5694,52.9467,\n    53.2185,50.7291,52.2359,53.2505,53.9712,51.6190,\n    53.5042,54.0084,54.5194,53.7171\n  ),\n  lon = c(\n    -0.1064, -1.8848, -1.8383, -0.2877, -0.0837, -2.2302,\n    -0.1910, -0.0854, -2.9663, -0.2215, -1.5707, -1.1499,\n    -2.9609, -0.4465, -2.2003, -2.2913, -1.6215, -1.1309,\n    -1.4704, -1.3995, -1.3884, -0.0660, -0.1650, -2.1308,\n    -3.2031, -3.9345, -2.1764, 1.3080, -1.9546, -1.7681,\n    -0.2312, -0.9715, -2.6534, -2.4883, -2.4654, -1.8767,\n    -1.0560, -3.0475, -1.4475, -0.0381, -2.1643, -3.0768,\n    -2.1793, -2.3023, -0.6128, -1.2185, 0.1559, -2.7161,\n    -3.5432, -0.0345, -2.2384, -0.4120, 1.1565, -1.2185,\n    -0.4016, -0.3958, -1.4984, 0.0366, -1.5005, -0.1983,\n    -1.4674, -2.1386, -1.7766, -1.2223, -3.0039, -2.6416,\n    -0.0505, -2.6896, -4.1755, -1.3533, -0.2319, -0.8122,\n    -1.6251, -0.7554, -1.0851, -2.5855, -2.7483, -1.4720,\n    -2.9157, -2.0722, -3.0335, -2.3364, -2.8530, -2.2858,\n    -1.4284, -0.0153, -2.9818, -3.2201, -0.1989, -2.6644,\n    -0.6974, 0.8879, 0.7061, 0.5518, -1.9961, -1.1444,\n    -0.5487, -3.5222, -0.9200, -2.1158, -1.0543, -0.2796,\n    -2.2906, -1.5173, -1.5593, -1.8624\n  )\n)\n}\n\n\nuk_states &lt;- ne_states(country = \"united kingdom\", returnclass = \"sf\")\n\n# Filter for England and Wales and group by regions\nengland_wales_regions &lt;- uk_states |&gt;\n  filter(geonunit %in% c(\"England\", \"Wales\")) |&gt;\n  group_by(region) |&gt;\n  summarise(geometry = st_union(geometry))\n\n\nengland_wales_regions &lt;- uk_states |&gt;\n  filter(geonunit %in% c(\"England\", \"Wales\")) |&gt;\n  group_by(region) |&gt;\n  summarise(geometry = st_union(geometry))\n\npos &lt;- position_jitter(width = 0.3, seed = 2)\n\npremier_league_teams &lt;- unique(filter(Data_England, Div==\"E0\" & Season==\"2024/2025\")$HomeTeam)\n\n\n# convert stadiums to sf\nstadiums_sf &lt;- st_as_sf(\n  stadiums,\n  coords = c(\"lon\", \"lat\"),\n  crs = 4326\n)\n# count stadiums per region (point-in-polygon)\nstadiums_by_region &lt;- st_join(stadiums_sf, england_wales_regions, join = st_within) |&gt;\n  st_drop_geometry() |&gt;\n  count(region, name = \"n_teams\")\n\n# join counts back to regions\nengland_wales_regions_cnt &lt;- england_wales_regions |&gt;\n  left_join(stadiums_by_region, by = \"region\")\n\npremier_league_teams &lt;- unique(\n  filter(Data_England, Div == \"E0\", Season == \"2024/2025\")$HomeTeam\n)\n\nggplot() +\n  geom_sf(data = england_wales_regions_cnt,\n          aes(fill = n_teams), color = \"white\", linewidth = 0.3) +\n  scale_fill_gradient(\n    name  = \"Number of teams\",\n    low   = \"lightblue\",\n    high  = \"darkblue\",\n    na.value = \"grey90\"\n  ) +\n  geom_point(data = stadiums, aes(x = lon, y = lat),\n             color = \"black\", size = 2.5, alpha = 0.5) +\n  geom_label_repel(\n    data = stadiums |&gt; filter(team %in% premier_league_teams),\n    aes(x = lon, y = lat, label = team),\n    min.segment.length = 0, seed = 42, max.overlaps = 30,\n    size = 2.5\n  ) +\n  coord_sf(xlim = c(-6, 2), ylim = c(50, 56)) +\n  labs(\n    title = \"Location of English Football Club Stadiums\",\n    caption = \"Fill = number of stadiums per region; labels = Premier League 2024/2025 clubs\"\n  ) +\n   my_custom_theme()\n\n\n\n\n\n\n\n\n\n\n\n3.4.2 Tier dynamics\n\n\nCode\nData_England_Matches=Data_England |&gt;\n  group_by(Season, Div) |&gt;\n  summarise(count=n(),\n            teams=n_distinct(HomeTeam))\n\n\n\nx=Data_England |&gt;\n  filter(is.na(Tier)==T)\n\n# Get unique teams and their tiers by season\nteam_timeline &lt;- Data_England |&gt;\n  select(Season, HomeTeam, Tier, League) |&gt;\n  rename(Team = HomeTeam) |&gt;\n  bind_rows(\n    Data_England |&gt;\n      select(Season, AwayTeam, Tier, League) |&gt;\n      rename(Team = AwayTeam)\n  ) |&gt;\n  distinct(Season, Team, Tier, League) |&gt;\n  arrange(Team, Season)\n\nTeams=Data_England |&gt;\n  group_by(HomeTeam) |&gt;\n  summarise(conteo=n(),\n            divs=n_distinct(Tier))\n\nTeams=Teams |&gt;\n  filter(divs&gt;=4)\n\nselected_teams=unique(Teams$HomeTeam)\n\nteams_timeline &lt;- team_timeline |&gt;\n  filter(Team %in% Teams$HomeTeam) |&gt;\n  complete(Season = unique(team_timeline$Season), Team = selected_teams) |&gt;\n  group_by(Team) |&gt;\n  fill(Tier, League, .direction = \"downup\")\n\n\ncurrent_tiers &lt;- teams_timeline |&gt;\n  group_by(Team) |&gt;\n  filter(Season == max(Season)) |&gt;\n  select(Team, Current_Tier = Tier)\n\nteams_timeline &lt;- teams_timeline |&gt;\n  left_join(current_tiers, by = \"Team\")\n\n\n\n# Facet wrap - each team gets its own panel\nteams_timeline &lt;- team_timeline |&gt;\n  filter(Team %in% selected_teams) |&gt;\n  complete(Season = unique(team_timeline$Season), Team) |&gt;\n  group_by(Team) |&gt;\n  fill(Tier, League, .direction = \"down\") |&gt;\n  filter(!is.na(Tier))\n\nggplot(teams_timeline, aes(x = Season, y = Tier, group = Team)) +\n  geom_line(color = \"steelblue\", linewidth = 1.2) +\n  geom_point(color = \"darkblue\", size = 2) +\n  scale_y_discrete(limits=rev) +\n  facet_wrap(~ Team, ncol = 4) +  # 4 columns, 5 rows for 17 teams\n  labs(\n    title = \"Team Performance Timelines (1993-2024)\",\n    x = \"Season\",\n    y = \"Tier\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 8),\n    axis.text.y = element_text(size = 8),\n    strip.text = element_text(face = \"bold\", size = 9),\n    panel.spacing = unit(1, \"lines\")\n  )\n\n\n\n\n\n\n\n\n\nTo Do: Add number of teams per region. (?)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "results.html#relation-among-numeric-variables",
    "href": "results.html#relation-among-numeric-variables",
    "title": "3  Results",
    "section": "3.5 Relation among numeric variables",
    "text": "3.5 Relation among numeric variables\n\n\nCode\npremier_full_complete &lt;- premier_full |&gt;\n  group_by(Season) |&gt;\n  filter(n() == 380) |&gt;\n  ungroup()\n\nteam_stats &lt;- bind_rows(\n  premier_full_complete |&gt;\n    transmute(\n      Season,\n      Team   = HomeTeam,\n      GF     = FTHG,\n      GA     = FTAG,\n      ShotsFor  = HS,\n      ShotsAg   = AS,\n      SOTFor    = HST,\n      SOTAg     = AST\n    ),\n  premier_full_complete |&gt;\n    transmute(\n      Season,\n      Team   = AwayTeam,\n      GF     = FTAG,\n      GA     = FTHG,\n      ShotsFor  = AS,\n      ShotsAg   = HS,\n      SOTFor    = AST,\n      SOTAg     = HST\n    )\n) |&gt;\n  group_by(Season, Team) |&gt;\n  summarise(\n    matches                  = n(),\n    goals_for                = sum(GF,        na.rm = TRUE),\n    goals_against            = sum(GA,        na.rm = TRUE),\n    shots_for                = sum(ShotsFor,  na.rm = TRUE),\n    shots_against            = sum(ShotsAg,   na.rm = TRUE),\n    shots_on_target_for      = sum(SOTFor,    na.rm = TRUE),\n    shots_on_target_against  = sum(SOTAg,     na.rm = TRUE),\n    .groups = \"drop\"\n  )\n\nseasons_focus &lt;- c(\"2000/2001\", \"2004/2005\", \"2009/2010\", \"2014/2015\", \"2019/2020\", \"2023/2024\")\nteam_stats_focus &lt;- team_stats |&gt;\n  filter(Season %in% seasons_focus) |&gt;\n  mutate(\n    Season = factor(Season, levels = seasons_focus)\n  )\n\nteam_stats_scaled &lt;- team_stats_focus |&gt;\n  mutate(\n    goals_for_s               = rescale(goals_for),\n    shots_on_target_for_s     = rescale(shots_on_target_for),\n    goals_against_s           = rescale(goals_against),\n    shots_on_target_against_s = rescale(shots_on_target_against)\n  )\n\n\np &lt;- GGally::ggparcoord(\n  data        = team_stats_scaled,\n  columns     = match(c(\"goals_for_s\", \"shots_on_target_for_s\", \"goals_against_s\", \"shots_on_target_against_s\"), names(team_stats_scaled)),\n  groupColumn = \"Season\",\n  scale       = \"globalminmax\", \n  alphaLines  = 0.6,\n  showPoints  = TRUE\n) +\n  scale_x_discrete(labels = c(\n    \"goals_for_s\" = \"Goals For\",\n    \"shots_on_target_for_s\" = \"SoT For\",\n    \"goals_against_s\" = \"Goals Against\",\n    \"shots_on_target_against_s\" = \"SoT Against\"\n  )) +\n  labs(title = \"Team Profiles Across Seasons\", x = \"Metric\", y = \"Scaled Value\") +\n  theme_minimal(base_size = 11) +\n  theme(legend.position = \"bottom\")\n\n\np$data$TeamName &lt;- team_stats_scaled$Team[p$data$.ID]\n\n# Update the tooltip text\np &lt;- p + aes(text = paste0(\n  \"&lt;b&gt;\", TeamName, \"&lt;/b&gt;\",\n  \"&lt;br&gt;Season: \", Season,\n  \"&lt;br&gt;Metric: \", variable,\n  \"&lt;br&gt;Value: \", round(value, 2)\n))\n\n\nggplotly(p, tooltip = \"text\") |&gt;\n  layout(\n    updatemenus = list(\n      list(\n        type = \"buttons\", direction = \"right\", xanchor = \"center\", yanchor = \"bottom\", x = 0.5, y = -0.15,        \n        buttons = list(\n          list(method = \"restyle\", args = list(\"visible\", list(TRUE, TRUE, TRUE, TRUE, TRUE, TRUE)), label = \"All\"),\n          list(method = \"restyle\", args = list(\"visible\", list(TRUE, FALSE, FALSE, FALSE, FALSE, FALSE)), label = \"2000/01\"),\n          list(method = \"restyle\", args = list(\"visible\", list(FALSE, TRUE, FALSE, FALSE, FALSE, FALSE)), label = \"2004/05\"),\n          list(method = \"restyle\", args = list(\"visible\", list(FALSE, FALSE, TRUE, FALSE, FALSE, FALSE)), label = \"2009/10\"),\n          list(method = \"restyle\", args = list(\"visible\", list(FALSE, FALSE, FALSE, TRUE, FALSE, FALSE)), label = \"2014/15\"),\n          list(method = \"restyle\", args = list(\"visible\", list(FALSE, FALSE, FALSE, FALSE, TRUE, FALSE)), label = \"2019/20\"),\n          list(method = \"restyle\", args = list(\"visible\", list(FALSE, FALSE, FALSE, FALSE, FALSE, TRUE)), label = \"2023/24\")\n        )\n      )\n    )\n  )\n\n\n\n\n\n\nAcross teams, we observe strong positive associations between shots on target and goals scored, as well as between shots on target conceded and goals conceded. However, shots on target generated by a team no meaningful relationship with the goals it concedes, suggesting that offensive productivity and defensive vulneratiblity operate independently.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "results.html#detection-of-clusters",
    "href": "results.html#detection-of-clusters",
    "title": "3  Results",
    "section": "3.6 Detection of clusters",
    "text": "3.6 Detection of clusters\nWe know that many of the numerical variables in our dataset are related, so within each league we would like to identify clusters of teams that share similar behavior across seasons. Based on these clusters, we could create indexes and provide explanations for the patterns observed.\n\n\nCode\n# Create team-level aggregated data\nmost_recent_season &lt;- max(Data_England$Season, na.rm = TRUE)\n\ncurrent_tier1_teams &lt;- Data_England |&gt;\n  filter(Div == \"E0\" & Season ==most_recent_season ) |&gt;\n  distinct(HomeTeam) |&gt;\n  pull(HomeTeam)\n\n\nteam_performance &lt;- Data_England |&gt;\n  # Home performances\n  select(Season, Team = HomeTeam, \n         Goals_For = FTHG, Goals_Against = FTAG,\n         Shots = HS, Shots_Target = HST,\n         Fouls = HF, Corners = HC,\n         Yellow_Cards = HY, Red_Cards = HR,\n         Result = FTR) |&gt;\n  mutate(Venue = \"Home\") |&gt;\n  # Away performances\n  bind_rows(\n    Data_England |&gt;\n      filter(Div == \"E0\") |&gt;\n      select(Season, Team = AwayTeam,\n             Goals_For = FTAG, Goals_Against = FTHG,\n             Shots = AS, Shots_Target = AST,\n             Fouls = AF, Corners = AC,\n             Yellow_Cards = AY, Red_Cards = AR,\n             Result = FTR) |&gt;\n      mutate(Venue = \"Away\")\n  ) |&gt;\n  group_by(Team) |&gt;\n  summarise(\n    # Goal metrics\n    Avg_Goals_For = mean(Goals_For, na.rm = TRUE),\n    Avg_Goals_Against = mean(Goals_Against, na.rm = TRUE),\n    Goal_Difference = mean(Goals_For - Goals_Against, na.rm = TRUE),\n    \n    # Shooting metrics\n    Avg_Shots = mean(Shots, na.rm = TRUE),\n    Avg_Shots_Target = mean(Shots_Target, na.rm = TRUE),\n    Shot_Accuracy = ifelse(mean(Shots, na.rm = TRUE) &gt; 0,\n                           mean(Shots_Target, na.rm = TRUE) / mean(Shots, na.rm = TRUE),\n                           0),\n    \n    # Defensive metrics\n    Avg_Fouls = mean(Fouls, na.rm = TRUE),\n    Avg_Corners = mean(Corners, na.rm = TRUE),\n    \n    # Discipline metrics\n    Avg_Yellow_Cards = mean(Yellow_Cards, na.rm = TRUE),\n    Avg_Red_Cards = mean(Red_Cards, na.rm = TRUE),\n    \n    # WIN COUNTS - NEW ADDITIONS\n    Home_Wins = sum(Venue == \"Home\" & Result == \"H\", na.rm = TRUE),\n    Away_Wins = sum(Venue == \"Away\" & Result == \"A\", na.rm = TRUE),\n    Total_Wins = sum((Venue == \"Home\" & Result == \"H\") | (Venue == \"Away\" & Result == \"A\"), na.rm = TRUE),\n    \n    # Performance metrics\n    Win_Rate = Total_Wins / n(),\n    Draw_Rate = sum(Result == \"D\", na.rm = TRUE) / n(),\n    Loss_Rate = sum((Venue == \"Home\" & Result == \"A\") | (Venue == \"Away\" & Result == \"H\"), na.rm = TRUE) / n(),\n    \n    # Home/Away specific rates\n    Home_Win_Rate = Home_Wins / sum(Venue == \"Home\"),\n    Away_Win_Rate = Away_Wins / sum(Venue == \"Away\"),\n    \n    # Venue metrics\n    Home_Matches = sum(Venue == \"Home\"),\n    Away_Matches = sum(Venue == \"Away\"),\n    \n    # Sample size\n    Matches_Played = n(),\n    \n    .groups = 'drop'\n  ) |&gt;\n  filter(Matches_Played &gt;= 50)  # Only teams with sufficient data  # Only teams with sufficient data\n\n\nteam_performance=team_performance |&gt;\n  filter(Team %in% current_tier1_teams) \n# Select numeric variables for PCA\n\nteam_performance &lt;- team_performance |&gt;\n  mutate(across(where(is.numeric), ~ ifelse(is.nan(.), 0, .)))\n\nteam_performance &lt;- team_performance |&gt;\n  mutate_if(is.numeric, ~ifelse(is.infinite(.), 0, .))\n\n\npca_data &lt;- team_performance |&gt;\n  select(Avg_Goals_For, Avg_Goals_Against,\n         Avg_Shots, Avg_Shots_Target,\n         Avg_Fouls, Avg_Corners, Avg_Yellow_Cards, Avg_Red_Cards,\n         Draw_Rate,Home_Win_Rate,Away_Win_Rate) |&gt;\n  scale()  # Standardize the variables\n\nrownames(pca_data) &lt;- team_performance$Team\n\n\n# Perform PCA\npca_result &lt;- PCA(pca_data, graph = FALSE)\n\n# Basic biplot\nfviz_pca_biplot(pca_result, \n                repel = TRUE,\n                col.var = \"red\",\n                col.ind = \"blue\",\n                alpha.ind = 0.7,\n                title = \"Team Performance Biplot - All Variables\")\n\n\n\n\n\n\n\n\n\nTo Do: Explain PCA\n\n\nCode\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(lubridate)\nlibrary(ggplot2)\n\nbig6 &lt;- c(\"Liverpool\", \"Chelsea\", \"Arsenal\",\n          \"Man City\", \"Man United\", \"Tottenham\")\n\ndf_big6 &lt;- Data_England |&gt;\n  select(HomeTeam, AwayTeam, Date, FTR)|&gt;\n  mutate(\n    Date = lubridate::dmy(Date),\n    Month = lubridate::month(Date, label = TRUE)\n  )|&gt;\n  pivot_longer(\n    c(HomeTeam, AwayTeam),\n    names_to = \"HA\",\n    values_to = \"Team\"\n  ) |&gt;\n  filter(Team %in% big6) |&gt;\n  mutate(\n    Team_Result = case_when(\n      FTR == \"D\" ~ \"Draw\",\n      HA == \"HomeTeam\" & FTR == \"H\" ~ \"Win\",\n      HA == \"HomeTeam\" & FTR == \"A\" ~ \"Loss\",\n      HA == \"AwayTeam\" & FTR == \"A\" ~ \"Win\",\n      HA == \"AwayTeam\" & FTR == \"H\" ~ \"Loss\",\n      TRUE ~ NA_character_\n    )\n  )\n\ndf_big6_prop &lt;- df_big6 |&gt;\n  count(Team, Month, Team_Result) |&gt;\n  group_by(Team, Month) |&gt;\n  mutate(prop = n / sum(n))\n\ndf_big6_prop=df_big6_prop |&gt;filter(!Month %in% c(\"Jun\", \"Jul\")) |&gt;\n  mutate(Month = factor(Month, levels = c(\"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\", \n                                          \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\"))) \n\n\n\nggplot(df_big6_prop, aes(x = Month, y = prop, color = Team_Result, group = Team_Result)) +\n  geom_line(size = 1) +\n  geom_point(size = 2) +\n  facet_wrap(~ Team, ncol = 3) +\n  labs(\n    title = \"Monthly Result Proportions for Big 6 Teams\",\n    y = \"Proportion of Results\",\n    color = \"Result\"\n  ) +\n  theme_minimal(base_size = 12)\n\n\n\n\n\n\n\n\n\n\n\nCode\nggplot(df_big6_prop, aes(x = Month, y = Team_Result, fill = prop)) +\n  geom_tile(color = \"white\") +\n  facet_wrap(~ Team, ncol = 3) +\n  scale_fill_viridis_c(option = \"magma\", direction = -1) +\n  labs(\n    title = \"Heatmap of Result Proportions by Month (Big 6 Teams)\",\n    x = \"Month\",\n    y = \"Result\",\n    fill = \"Proportion\"\n  ) +\n  theme_minimal(base_size = 12)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "results.html#referee-analysys-is-there-bias",
    "href": "results.html#referee-analysys-is-there-bias",
    "title": "3  Results",
    "section": "3.7 Referee analysys, is there bias?",
    "text": "3.7 Referee analysys, is there bias?\nWe would like to explore different ways of analyzing referees behavior during matches to determine whether referees are biased toward home teams. We also want to examine if there is any relationship between league results and World Cup outcomes. In addition, we plan to calculate the differences between the probabilities provided by betting houses and the actual outcomes, as well as conduct other complementary analyses.\nTo Do: Decide which one to get\n\n\nCode\nlibrary(tidyverse)\n\ndf_clean &lt;- Data_England |&gt;\n  mutate(Referee_Clean = Referee) |&gt;\n  \n  # 1. Remove dots explicitly first (e.g., \"P. Walker\" -&gt; \"P Walker\")\n  mutate(Referee_Clean = str_remove_all(Referee_Clean, \"\\\\.\")) |&gt;\n  \n  # 2. Handle the \"Lastname, Firstname\" format (e.g., \"Yates, N\" -&gt; \"N Yates\")\n  # Regex explanation:\n  # ^(.*),      -&gt; Capture everything before the comma (Surname)\n  # \\s* -&gt; Match any spaces after comma\n  # (.*)$       -&gt; Capture everything after (Firstname/Initial)\n  # \\\\2 \\\\1     -&gt; Swap them (Firstname Surname)\n  mutate(Referee_Clean = str_replace(Referee_Clean, \"^(.*),\\\\s*(.*)$\", \"\\\\2 \\\\1\")) |&gt;\n  \n  # 3. Trim extra whitespace created by the swap\n  mutate(Referee_Clean = str_squish(Referee_Clean)) |&gt;\n  \n  # 4. Force to Title Case (e.g., \"n yates\" -&gt; \"N Yates\")\n  mutate(Referee_Clean = str_to_title(Referee_Clean)) |&gt;\n\n  # 5. Convert EVERYONE to \"Initial Surname\" format\n  # Regex explanation:\n  # ^(.)        -&gt; Capture the very first character (The Initial)\n  # .* -&gt; Match all the letters in the middle (ignore them)\n  # \\s+         -&gt; Match the space before the surname\n  # (.*)$       -&gt; Capture the last word (The Surname)\n  # \\\\1 \\\\2     -&gt; Rebuild as \"Initial space Surname\"\n  mutate(Referee_Final = str_replace(Referee_Clean, \"^(.).*\\\\s+(.*)$\", \"\\\\1 \\\\2\"))\n\n# --- Check the results ---\n# This will show you the original vs the cleaned version\ncheck_data &lt;- df_clean |&gt; \n  group_by(Referee, Referee_Final) |&gt; \n  summarise(conteo=n())\n\nData_England_Referee=df_clean |&gt;\n  filter(!Referee==\"Unknown\")|&gt;\n  select(-Referee)\n\nData_England_Referee=Data_England_Referee |&gt;\n  rename(Referee= Referee_Final)\n\nReferees=Data_England_Referee |&gt;\n  filter(is.na(Referee)==F )|&gt;\n  mutate(HomeWon=ifelse(FTR==\"H\",1,0),\n         AwayWon=ifelse(FTR==\"A\",1,0))|&gt;\n  group_by(\n    Referee\n  ) |&gt;\n  summarise(Count_matches=n(),\n            n_seasons=n_distinct(Season,na.rm=T),\n            n_tiers=n_distinct(Tier,na.rm=T),\n            Home_wins_count=sum(HomeWon,na.rm=T),\n            Away_wins_count=sum(AwayWon,na.rm=T))\n\nReferees=Referees |&gt;\n  filter(Count_matches&gt;=15)\n\nReferees |&gt;\n  arrange(desc(Count_matches)) |&gt;\n  slice_head(n = 30) |&gt;                 # top 30\n  mutate(Referee = fct_reorder(Referee, Count_matches)) |&gt;\n  ggplot(aes(x = Referee, y = Count_matches)) +\n  geom_segment(aes(xend = Referee, yend = 0), color = \"grey70\") +\n  geom_point(size = 3, color = \"darkgreen\") +\n  coord_flip() +\n  labs(\n    title = \"Top Referees by Match Count\",\n    x = \"Referee\",\n    y = \"Matches\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nCode\nReferees |&gt;\n  mutate(\n    home_win_rate = Home_wins_count / Count_matches,\n    away_win_rate = Away_wins_count / Count_matches\n  ) |&gt;\n  ggplot(aes(x = home_win_rate, y = away_win_rate, fill = Count_matches)) +\n  geom_point(alpha = 0.7, color = \"steelblue\") +\n  \n  labs(\n    title = \"Home vs Away Win Rates per Referee\",\n    x = \"Home Win Rate\",\n    y = \"Away Win Rate\",\n    size = \"Matches Refereed\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nCode\nReferees |&gt;\n  mutate(\n    home_win_rate = Home_wins_count / Count_matches\n  ) |&gt;\n  ggplot(aes(x = Count_matches, y = home_win_rate)) +\n  geom_point(alpha = 0.3, color = \"darkblue\") +\n  scale_y_log10()+\n  scale_x_log10()+\n  labs(\n    title = \"Do More Experienced Referees Show Less Home Bias?\",\n    x = \"Matches \",\n    y = \"Home Win Rate\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nCode\nReferees_Home_team=Data_England_Referee |&gt;\n  filter(!Referee==\"Unknown\")|&gt;\n  mutate(HomeWon=ifelse(FTR==\"H\",1,0),\n         AwayWon=ifelse(FTR==\"A\",1,0))|&gt;\n  group_by(\n    Referee, HomeTeam\n  ) |&gt;\n  summarise(Count_matches=n(),\n            n_seasons=n_distinct(Season,na.rm=T),\n            n_tiers=n_distinct(Tier,na.rm=T),\n            Home_wins_count=sum(HomeWon,na.rm=T),\n            Away_wins_count=sum(AwayWon,na.rm=T))\n\n\n\nReferees_Home_team &lt;- Referees_Home_team |&gt;\n  mutate(\n    Home_win_rate = Home_wins_count / Count_matches,\n    Total_matches = Count_matches\n  )\n\n# Filter for meaningful combinations (enough matches)\nsignificant_ref_team &lt;- Referees_Home_team |&gt;\n  filter(Total_matches &gt;= 25)  # Only consider referee-team pairs with 5+ matches\n\n# Heatmap\nggplot(significant_ref_team, aes(x = Referee, y = HomeTeam)) +\n  geom_tile(aes(fill = Home_win_rate), color = \"white\") +\n  scale_fill_gradient2(\n    low = \"blue\", mid = \"white\", high = \"red\", \n    midpoint = 0.5,  # Average home win rate\n    limits = c(0, 1),\n    name = \"Home Win Rate\"\n  ) +\n  labs(\n    title = \"Referee Home Team Win Rates\",\n    subtitle = \"Heatmap showing if referees favor certain home teams\",\n    x = \"Referee\",\n    y = \"Home Team\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 8),\n    axis.text.y = element_text(size = 7),\n    legend.position = \"bottom\"\n  )",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "results.html#fair-play",
    "href": "results.html#fair-play",
    "title": "3  Results",
    "section": "3.8 Fair play",
    "text": "3.8 Fair play\n\n\n\n\n\n\nNote\n\n\n\nCreo que debemos hacer algo con los ejes cuando tenemos temporadas. En algunas lo dejamos como Season: 2020/2021 y en otras como año: 2020. Voy a generar desde data England una variable que sea “Year”, sólo hay que ponernos de acuerdo si debería ser el año en que empezó o el año en que terminó la temporada.\n\n\n\n\nCode\nlibrary(dplyr)\nlibrary(tidyr)\n\ncards_fouls_yearly &lt;- premier_full_complete |&gt;\n  filter(as.numeric(substr(Season, 1, 4)) &gt;= 2000) |&gt;\n  group_by(Season) |&gt;\n  summarise(\n    n_matches = n(),\n    fouls_total  = sum(HF, na.rm = TRUE) + sum(AF, na.rm = TRUE),\n    yellow_total = sum(HY, na.rm = TRUE) + sum(AY, na.rm = TRUE),\n    red_total    = sum(HR, na.rm = TRUE) + sum(AR, na.rm = TRUE),\n    fouls_per_match  = fouls_total / n_matches,\n    yellow_per_match = yellow_total / n_matches,\n    red_per_match    = red_total / n_matches,\n    Year = as.numeric(substr(Season, 1, 4))\n  ) |&gt;\n  arrange(Year)\n\ncards_fouls_long &lt;- cards_fouls_yearly |&gt;\n  pivot_longer(\n    cols = c(fouls_per_match, yellow_per_match, red_per_match),\n    names_to = \"metric\",\n    values_to = \"value\"\n  ) |&gt;\n  mutate(\n    metric = factor(\n      metric,\n      levels = c(\"fouls_per_match\", \"yellow_per_match\", \"red_per_match\"),\n      labels = c(\"Fouls\", \"Yellow Cards\", \"Red Cards\")\n    )\n  )\n\nggplot(cards_fouls_long, aes(x = Year, y = value, color = metric)) +\n  geom_line(linewidth = 1.2) +\n  geom_point(size = 2) +\n  geom_smooth(method = \"loess\", se = FALSE, color = \"black\", linewidth = 0.5) +\n  facet_wrap(~ metric, scales = \"free_y\", nrow = 1) +\n  scale_color_manual(\n    values = c(\n      \"Fouls\" = \"steelblue\",\n      \"Yellow Cards\" = \"gold\",\n      \"Red Cards\" = \"red\"\n    )\n  ) +\n  labs(\n    title = \"Fouls and Cards per Match — Premier League\",\n    subtitle = \"Complete seasons (2000–2024)\",\n    x = \"Season\",\n    y = \"Per match\"\n  ) +\n  guides(color = \"none\") +  # Oculta la leyenda ya que los facets indican la categoría\n  theme_minimal(base_size = 13) +\n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    strip.text = element_text(face = \"bold\", size = 12)\n  )\n\n\n\n\n\n\n\n\n\nFrom 2000 to 2024, fouls per match show an overall decreasing trend, especially from 2000 to 2013, followed by a more stable pattern in recent years. This behavior can be related to better playing techniques and to a stricter strategies from referees. When looking at yellow cards over the same period, we observe a constant trend from 2000 to 2020. This suggests that, even though fouls decreased, referees continued issuing yellow cards at similar rates, which is evidence of a stricter interpretation of the rules. This aligns with the fact that the regulations have become stronger and penalize more unsporting conducts. Red cards, meanwhile, have historically been rare events in matches. Although they appear to decrease slightly, they remain at consistently low levels.\n\n\nCode\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(scales) \n\ncards_result_band &lt;- premier_full_complete |&gt;\n  mutate(\n    total_cards = HY + AY + HR + AR,\n    card_band = case_when(\n      total_cards &lt;= 1 ~ \"0–1 cards\",\n      total_cards &lt;= 3 ~ \"2–3 cards\",\n      total_cards &lt;= 5 ~ \"4–5 cards\",\n      TRUE            ~ \"6+ cards\"\n    )\n  ) |&gt;\n  filter(!is.na(FTR), !is.na(card_band)) |&gt;\n  group_by(card_band, FTR) |&gt;\n  summarise(n = n(), .groups = \"drop\") |&gt;\n  group_by(card_band) |&gt;\n  mutate(prop = n / sum(n)) |&gt;\n  ungroup()\n\ncards_result_band &lt;- cards_result_band |&gt;\n  mutate(\n    FTR = factor(FTR, levels = c(\"H\", \"D\", \"A\"))\n  )\n\nggplot(cards_result_band,\n       aes(x = FTR, y = card_band, fill = prop)) +\n  geom_tile(color = \"white\") +\n  geom_text(aes(label = percent(prop, accuracy = 1)),\n            color = \"black\", size = 3) +\n  scale_fill_gradientn(\n  colours = c(\"#f7fbff\", \"#c6dbef\", \"#6baed6\", \"#08519c\"),\n  limits  = c(0, 1),                \n  breaks  = c(0, 0.25, 0.5, 0.75, 1),\n  labels  = scales::percent,\n  name    = \"Proportion of matches\"\n) +\n\n  labs(\n    title    = \"Match Result vs. Card Intensity — Premier League\",\n    subtitle = \"Rows: total cards in the match (yellow + red)\",\n    x        = \"Full-time result (FTR)\",\n    y        = \"Card intensity band\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    panel.grid = element_blank()\n  )\n\n\n\n\n\n\n\n\n\nThis graph shows the joint distribution between card intensity and full-time result of a match. For all levels of card intensity, most matches are won by the home team. Nevertheless, this home advantage decreases as card intensity rises: home wins drop from 52% in low-card matches (0-1 cards) to 44% in high-card matches (6+ cards). On the other hand, away wins remain practically constant at 28% across all bands, suggesting that this result is not affected by card intensity. Draws also increase along with card intensity, rising from 20% to 28%.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "conclusion.html",
    "href": "conclusion.html",
    "title": "4  Conclusion",
    "section": "",
    "text": "To do. Explain something like the results of our questions and stuff that was interesting.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Conclusion</span>"
    ]
  }
]