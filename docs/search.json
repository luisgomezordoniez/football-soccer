[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "The Beautiful Game",
    "section": "",
    "text": "1 Introduction\nWe are interested in analyzing football soccer match results and statistics from several major leagues around the world. Soccer is one of the most popular sports globally, and its relevance is growing as the next World Cup approaches. We aim to explore how common match statistics such as goals, shots on target, and fouls, affect not only the outcome of individual games but also overall team performance throughout a season. We also plan to study how team rankings evolve over time, whether different strategic patterns can be identified, and how accurate betting odds are in predicting results. Through this project, we hope to discover additional insights about the game and share interesting findings.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "2  Data",
    "section": "",
    "text": "2.1 Description\nWe gather our data from the website “https://www.football-data.co.uk/”, the website have data from matches across the main leagues in Europe and America. We will focus our analysys in the leagues of England, since we have data for the top 4 tiers.\nTo do: Explain the dataset, maybe talk about the variables (?)\nKey to results data:\nMatch Statistics (where available)\nCode\nlibrary(dplyr)\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\nCode\nlibrary(tidyr)\nlibrary(readr)\nlibrary(dplyr)\nlibrary(forcats)\nlibrary(ggplot2)\n\nData_England &lt;- read_csv(\"https://github.com/luisgomezordoniez/football-soccer/raw/refs/heads/main/Data_England.csv\")\n\n\nRows: 64872 Columns: 28\n\n\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (11): Div, Date, HomeTeam, AwayTeam, FTR, HTR, Referee, Country, Season...\ndbl  (16): FTHG, FTAG, HTHG, HTAG, HS, AS, HST, AST, HF, AF, HC, AC, HY, AY,...\ntime  (1): Time\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nCode\n#summary(Data_England)\n\nData_England$League &lt;- factor(Data_England$League, levels =c(\"Premier League\", \"Championship\",\"League One\", \"League Two\"), ordered = TRUE)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#description",
    "href": "data.html#description",
    "title": "2  Data",
    "section": "",
    "text": "Div = League Division\nDate = Match Date (dd/mm/yy)\nTime = Time of match kick off\nHomeTeam = Home Team\nAwayTeam = Away Team\nFTHG and HG = Full Time Home Team Goals\nFTAG and AG = Full Time Away Team Goals\nFTR and Res = Full Time Result (H=Home Win, D=Draw, A=Away Win)\nHTHG = Half Time Home Team Goals\nHTAG = Half Time Away Team Goals\nHTR = Half Time Result (H=Home Win, D=Draw, A=Away Win)\n\n\n\nAttendance = Crowd Attendance\nReferee = Match Referee\nHS = Home Team Shots\nAS = Away Team Shots\nHST = Home Team Shots on Target\nAST = Away Team Shots on Target\nHHW = Home Team Hit Woodwork\nAHW = Away Team Hit Woodwork\nHC = Home Team Corners\nAC = Away Team Corners\nHF = Home Team Fouls Committed\nAF = Away Team Fouls Committed\nHFKC = Home Team Free Kicks Conceded\nAFKC = Away Team Free Kicks Conceded\nHO = Home Team Offsides\nAO = Away Team Offsides\nHY = Home Team Yellow Cards\nAY = Away Team Yellow Cards\nHR = Home Team Red Cards\nAR = Away Team Red Cards",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#missing-value-analysis",
    "href": "data.html#missing-value-analysis",
    "title": "2  Data",
    "section": "2.2 Missing value analysis",
    "text": "2.2 Missing value analysis\n\n\nCode\nmissing_summary &lt;- Data_England %&gt;%\n  group_by(League, Season) %&gt;%\n  summarise(across(everything(), ~100* mean(is.na(.))), .groups = \"drop\") %&gt;%  # proportion missing\n  pivot_longer(\n    cols = -c(League, Season),\n    names_to = \"variable\",\n    values_to = \"prop_missing\"\n  ) %&gt;%\n  group_by(variable) %&gt;%\n  mutate(total_missing = mean(prop_missing, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  mutate(variable = fct_reorder(variable, total_missing, .desc = TRUE))\n\nmissing_summary=missing_summary |&gt;\n  mutate(Season=substr(Season, 6,10))\n\nggplot(missing_summary, aes(x = variable, y = Season, fill = prop_missing)) +\n  geom_tile(color = \"white\") +\n  facet_wrap(~ League, scales = \"free_y\") +\n  scale_fill_continuous(palette = c(\"white\",\"#FEE0D2\", \"#FC9272\"))+\n  labs(\n    title = \"Proportion of Missing Values Across Seasons and Columns by League\",\n    x = \"Variable\",\n    y = \"Season\",\n    fill=\"Missing (%)\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),\n    panel.spacing = unit(1, \"lines\")\n  )\n\n\n\n\n\n\n\n\n\n\n\nCode\nlibrary(ggplot2)\nlibrary(patchwork)\n\n# Boxplots for FTHG and FTAG\np1 &lt;- ggplot(Data_England, aes(y = FTHG)) +\n  geom_boxplot(fill = \"lightblue\", alpha = 0.7, outlier.color = \"red\", outlier.size = 2) +\n  labs(title = \"Home Goals (FTHG) - Boxplot\", y = \"Goals\") +\n  theme_minimal()\n\np2 &lt;- ggplot(Data_England, aes(y = FTAG)) +\n  geom_boxplot(fill = \"lightgreen\", alpha = 0.7, outlier.color = \"red\", outlier.size = 2) +\n  labs(title = \"Away Goals (FTAG) - Boxplot\", y = \"Goals\") +\n  theme_minimal()\n\np1 + p2\n\n\n\n\n\n\n\n\n\nTo Do: Explain a bit what we see, maybe we can add another step of explaining our raw data.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "results.html",
    "href": "results.html",
    "title": "3  Enlglish football through the years",
    "section": "",
    "text": "We want to see how soccer has changed through the years in terms of attack and defense. Our hypothesis is that the english football has become more competitive. For proving this hypothesis we will analyze the differences among the teams that conform the Premier League, the dominance and the results of the matches.\nFirst of all, we know that goals can be a strong indicator to understand this, so we plan to base our first analysis on the average number of goals scored by teams.\n\n\nCode\nlibrary(dplyr)\nlibrary(lubridate)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(lubridate)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\nlibrary(rnaturalearth)\nlibrary(rnaturalearthhires)\nlibrary(sf)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(ggrepel)\nlibrary(readr)\nlibrary(forcats)\nlibrary(FactoMineR)\nlibrary(factoextra)\nlibrary(ggplot2)\nlibrary(dplyr)\n# Load required libraries\nlibrary(ggplot2)\nlibrary(dplyr)\n\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(ggalluvial)\nlibrary(lubridate)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(ggalluvial)\nlibrary(dplyr)\nlibrary(GGally)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(scales)   # para rescale()\nlibrary(GGally)\nlibrary(ggplot2)\nlibrary(vcd)\n\n\nData_England &lt;- read_csv(\"https://github.com/luisgomezordoniez/football-soccer/raw/refs/heads/main/Data_England.csv\")\n\n#summary(Data_England)\n\nData_England$League &lt;- factor(Data_England$League, levels =c(\"Premier League\", \"Championship\",\"League One\", \"League Two\"), ordered = TRUE)\n\n\n\n\nCode\n# Average goals through the years, by local and away.\n# Cleveland plots for the average goals by league through the years.\n\n\npremier_full &lt;- Data_England |&gt;\n  filter(Div == \"E0\")\n\n#dim(premier_full)\n\n#premier_full |&gt;\n#  select(Season, Date, HomeTeam, AwayTeam, FTHG, FTAG) |&gt;\n#  head(20)\n\n#premier_full |&gt;\n#  count(Season) |&gt;\n#  arrange(Season) |&gt;\n#  print(n = Inf)\n\n\n\n\npremier_full &lt;- premier_full |&gt;\n  mutate(Date = dmy(Date))\n\n#premier_full |&gt;\n#  select(Season, Date, HomeTeam, AwayTeam) |&gt;\n#  head(10)\n\n#summary(premier_full$Date)\n\npremier_full &lt;- premier_full |&gt;\n  mutate(Year = year(Date))\n\n#premier_full |&gt;\n#  select(Season, Date, Year, HomeTeam, AwayTeam) |&gt;\n#  head(12)\n\n#premier_full |&gt;\n#  count(Year) |&gt;\n#  arrange(Year) |&gt;\n#  print(n = Inf)\n\npremier_full &lt;- premier_full |&gt;\n  mutate(TotalGoals = FTHG + FTAG)\n\n#premier_full |&gt;\n#  select(Season, Date, HomeTeam, AwayTeam,\n#         FTHG, FTAG, TotalGoals) |&gt;\n#  head(10)\n\n#summary(premier_full$TotalGoals)\n\npremier_full &lt;- premier_full |&gt;\n  group_by(Season) |&gt;\n  filter(n() == 380) |&gt;\n  ungroup()\n\n#premier_full |&gt;\n#  count(Season) |&gt;\n#  arrange(Season)\n\npremier_goals &lt;- premier_full |&gt;\n  select(Season, Year, HomeTeam, AwayTeam,\n         FTHG, FTAG, TotalGoals)\n\n#head(premier_goals)\n#summary(premier_goals)\n\npremier_goals_yearly &lt;- premier_goals |&gt;\n  group_by(Year) |&gt;\n  summarise(\n    avg_home_goals  = mean(FTHG, na.rm = TRUE),\n    avg_away_goals  = mean(FTAG, na.rm = TRUE),\n    avg_total_goals = mean(TotalGoals, na.rm = TRUE)\n  )\n\n#premier_goals_yearly |&gt;\n#  head(15)\n\n#premier_goals_yearly |&gt;\n#  tail(10)\n\n#summary(premier_goals_yearly)\n\n\npremier_goals_yearly |&gt;\n  ggplot(aes(x = Year)) +\n  geom_line(aes(y = avg_home_goals, color = \"Home\"), linewidth = 1) +\n  geom_point(aes(y = avg_home_goals, color = \"Home\"), size = 2) +\n  geom_line(aes(y = avg_away_goals, color = \"Away\"), linewidth = 1) +\n  geom_point(aes(y = avg_away_goals, color = \"Away\"), size = 2) +\n  scale_color_manual(values = c(\"Home\" = \"#1f77b4\", \"Away\" = \"#d62728\")) +\n  labs(\n    title = \"Average Home and Away Goals per Season — Premier League\",\n    subtitle = \"Only complete seasons (380 matches per season)\",\n    x = \"Year\",\n    y = \"Average Goals per Match\",\n    color = \"Team\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    legend.position = \"bottom\",\n    plot.title = element_text(size = 14, face = \"bold\")\n  )\n\n\n\n\n\n\n\n\n\nWhile the average number of goals by home teams has remained relatively stable since 1993, away teams show a clear upward trend in goals, reflecting more offensive strategies, especially since 2015. This suggests a reduction in the traditional home-field advantage.\n\n\nCode\ndata_cleveland &lt;- premier_goals_yearly |&gt;\n  pivot_longer(\n    cols = c(avg_home_goals, avg_away_goals, avg_total_goals),\n    names_to  = \"type\",\n    values_to = \"value\"\n  ) |&gt;\n  mutate(\n    type = case_when(\n      type == \"avg_home_goals\"  ~ \"Home Goals\",\n      type == \"avg_away_goals\"  ~ \"Away Goals\",\n      type == \"avg_total_goals\" ~ \"Total Goals\"\n    )\n  )\n\nggplot(data_cleveland, aes(x = value, y = factor(Year))) +\n  geom_point(size = 2, color = \"black\") +\n  geom_segment(\n    aes(x = 0, xend = value, y = factor(Year), yend = factor(Year)),\n    linewidth = 0.6,\n    color = \"gray60\"\n  ) +\n  facet_wrap(~ type, scales = \"free_x\", ncol = 1) +\n  labs(\n    title = \"Cleveland Plot — Average Goals per Season (Premier League)\",\n    x = \"Average Goals per Match\",\n    y = \"Season (Year)\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    panel.spacing = unit(1, \"lines\"),\n    strip.text = element_text(size = 12, face = \"bold\"),\n    plot.title = element_text(size = 16, face = \"bold\")\n  )\n\n\n\n\n\n\n\n\n\ni. Away goals\nBetween 1993 and 2010, away teams scored about 1.10-1.15 goals per match, but since 2011 this number has increased to around 1.20-1.25. Starting in 2018, we can observe a sustained raise in away goals, reaching historic highs in 2023 and 2024, when they exceeded 1.45 goals per match.\nii. Home goals\nHome teams have consistently scored between 1.45 and 1.65 goals per match throughout the entire period, with small drops in 2008 and 2015. Recently, in 2023, there was an increase, but not one strong enough to confirm an upward trend.\nConclusion\nHome-field advantage has decreased significantly over the years. The recent offensive surge in the Premier League comes mainly from away teams.\n\n\nCode\npremier_full_complete &lt;- premier_full |&gt;\n  group_by(Season) |&gt;\n  filter(n() == 380) |&gt;\n  ungroup()\n\n# Proportion of results: H, A, D\nresults_yearly &lt;- premier_full_complete |&gt;\n  group_by(Year, FTR) |&gt;\n  summarise(n = n(), .groups = \"drop\") |&gt;\n  group_by(Year) |&gt;\n  mutate(prop = n / sum(n)) |&gt;\n  ungroup()\n\n# Proportion of Match Results per Season — Premier League\nresults_yearly |&gt;\n  ggplot(aes(x = Year, y = prop, fill = FTR)) +\n  geom_area(alpha = 0.8) +\n  scale_fill_brewer(\n    palette = \"Set1\",                \n    labels = c(\"H\" = \"Home win\",\n               \"D\" = \"Draw\",\n               \"A\" = \"Away win\"),\n    name = \"Result\"\n  ) +\n  labs(\n    title = \"Proportion of Match Results per Season — Premier League\",\n    subtitle = \"Only complete seasons (380 matches per season)\",\n    x = \"Year\",\n    y = \"Proportion of Matches\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    legend.position = \"bottom\",\n    plot.title = element_text(size = 14, face = \"bold\")\n  )\n\n\n\n\n\n\n\n\n\nOver the past three decades, Premier League results show a decrease in draws, an increase in away-team victories, and relatively stable home-team victories. This suggests that the league has become more competitive and that the traditional home-field advantage has gradually diminished.\n\n4 Location of Teams\nWe have 116 teams across all the tiers, we can see that London and\n\n\nCode\n{\n  stadiums &lt;- data.frame(\n  team = c(\n    \"Arsenal\",\"Aston Villa\",\"Bournemouth\",\"Brentford\",\"Brighton\",\"Burnley\",\n    \"Chelsea\",\"Crystal Palace\",\"Everton\",\"Fulham\",\"Leeds\",\"Leicester\",\n    \"Liverpool\",\"Luton\",\"Man City\",\"Man United\",\"Newcastle\",\"Nott'm Forest\",\n    \"Sheffield United\",\"Southampton\",\"Sunderland\",\"Tottenham\",\"West Ham\",\n    \"Wolves\",\"Cardiff\",\"Swansea\",\"Stoke\",\"Norwich\",\"West Brom\",\"Huddersfield\",\n    \"QPR\",\"Reading\",\"Wigan\",\"Blackburn\",\"Bolton\",\"Birmingham\",\"Portsmouth\",\n    \"Blackpool\",\"Derby\",\"Grimsby\",\"Stockport\",\"Tranmere\",\"Port Vale\",\"Bury\",\n    \"Rushden & D\",\"Hartlepool\",\"Dag and Red\",\"Hereford\",\"Torquay\",\"Boston\",\n    \"Kidderminster\",\"Scarborough\",\"Ipswich\",\"Middlesbrough\",\"Watford\",\"Hull\",\n    \"Coventry\",\"Charlton\",\"Sheffield Weds\",\"Wimbledon\",\"Barnsley\",\"Oldham\",\n    \"Swindon\",\"Oxford\",\"Wrexham\",\"Bristol City\",\"Millwall\",\"Preston\",\n    \"Plymouth\",\"Rotherham\",\"Peterboro\",\"Wycombe\",\"Burton\",\"Milton Keynes Dons\",\n    \"Doncaster\",\"Bristol Rvs\",\"Shrewsbury\",\"Cambridge\",\"Carlisle\",\"Cheltenham\",\n    \"Fleetwood Town\",\"Accrington\",\"Morecambe\",\"Forest Green\",\"Chesterfield\",\n    \"Leyton Orient\",\"Newport County\",\"Barrow\",\"Sutton\",\"Yeovil\",\"Scunthorpe\",\n    \"Colchester\",\"Southend\",\"Gillingham\",\"Walsall\",\"Notts County\",\"Lincoln\",\n    \"Exeter\",\"Northampton\",\"Macclesfield\",\"York\",\"Barnet\",\"Salford\",\n    \"Harrogate\",\"Darlington\",\"Halifax\"\n  ),\n  stadium = c(\n    \"Emirates Stadium\",\"Villa Park\",\"Vitality Stadium\",\"Gtech Community Stadium\",\n    \"Falmer Stadium (AMEX)\",\"Turf Moor\",\"Stamford Bridge\",\"Selhurst Park\",\n    \"Goodison Park\",\"Craven Cottage\",\"Elland Road\",\n    \"King Power Stadium\",\"Anfield\",\"Kenilworth Road\",\"Etihad Stadium\",\n    \"Old Trafford\",\"St James' Park\",\"The City Ground\",\"Bramall Lane\",\n    \"St Mary's Stadium\",\"Stadium of Light\",\"Tottenham Hotspur Stadium\",\n    \"London Stadium\",\"Molineux Stadium\",\"Cardiff City Stadium\",\n    \"Swansea.com Stadium\",\"Bet365 Stadium\",\"Carrow Road\",\"The Hawthorns\",\n    \"John Smith's Stadium\",\"Loftus Road\",\"Select Car Leasing Stadium\",\n    \"DW Stadium\",\"Ewood Park\",\"Toughsheet Community Stadium\",\"St Andrew's\",\n    \"Fratton Park\",\"Bloomfield Road\",\"Pride Park Stadium\",\"Blundell Park\",\n    \"Edgeley Park\",\"Prenton Park\",\"Vale Park\",\"Gigg Lane\",\n    \"Hayden Road\",\"Victoria Park\",\"Victoria Road\",\"Edgar Street\",\n    \"Plainmoor\",\"York Street\",\"Aggborough\",\"McCain Stadium\",\n    \"Portman Road\",\"Riverside Stadium\",\"Vicarage Road\",\"MKM Stadium\",\n    \"Coventry Building Society Arena\",\"The Valley\",\"Hillsborough\",\n    \"Plough Lane\",\"Oakwell\",\"Boundary Park\",\"County Ground\",\n    \"Kassam Stadium\",\"Racecourse Ground\",\"Ashton Gate\",\"The Den\",\"Deepdale\",\n    \"Home Park\",\"New York Stadium\",\"London Road Stadium\",\n    \"Adams Park\",\"Pirelli Stadium\",\"Stadium MK\",\"Keepmoat Stadium\",\n    \"Memorial Stadium\",\"Montgomery Waters Meadow\",\"Abbey Stadium\",\n    \"Brunton Park\",\"Whaddon Road\",\"Highbury Stadium\",\"Crown Ground\",\n    \"Mazuma Mobile Stadium\",\"The New Lawn\",\"Technique Stadium\",\"Brisbane Road\",\n    \"Rodney Parade\",\"Holker Street\",\"Gander Green Lane\",\"Huish Park\",\n    \"Glanford Park\",\"JobServe Community Stadium\",\"Roots Hall\",\n    \"Priestfield Stadium\",\"Bescot Stadium\",\"Meadow Lane\",\"Sincil Bank\",\n    \"St James Park\",\"Sixfields Stadium\",\"Moss Rose\",\"Bootham Crescent\",\n    \"The Hive Stadium\",\"Peninsula Stadium\",\"Wetherby Road\",\"Blackwell Meadows\",\n    \"The Shay\"\n  ),\n  lat = c(\n    51.5548,52.5091,50.7352,51.4909,50.8617,53.7891,\n    51.4817,51.3983,53.4387,51.4749,53.7788,52.6201,\n    53.4308,51.8841,53.4830,53.4631,54.9756,52.9392,\n    53.3703,50.9080,54.9144,51.6033,51.5387,52.5901,\n    51.4705,51.6429,52.9881,52.6226,52.5090,53.6499,\n    51.5093,51.4223,53.5463,53.7287,53.5807,52.4759,\n    50.7930,53.8055,52.9225,53.5683,53.4087,53.3779,\n    53.0335,53.5939,52.3338,54.6853,51.5593,52.0649,\n    50.4746,52.9691,52.3800,54.2770,52.0553,54.5828,\n    51.6501,53.7469,52.4497,51.4862,53.4283,51.4287,\n    53.5522,53.5517,51.5647,51.7166,53.0519,51.4402,\n    51.4851,53.7719,50.3804,53.4289,52.5646,51.6210,\n    52.8124,52.0084,53.5186,51.4854,52.6938,52.2039,\n    54.8931,51.9056,53.9248,53.7431,54.0723,51.6427,\n    53.2423,51.5583,51.5873,54.1202,51.3653,50.9328,\n    53.5850,51.9213,51.5458,51.3857,52.5694,52.9467,\n    53.2185,50.7291,52.2359,53.2505,53.9712,51.6190,\n    53.5042,54.0084,54.5194,53.7171\n  ),\n  lon = c(\n    -0.1064, -1.8848, -1.8383, -0.2877, -0.0837, -2.2302,\n    -0.1910, -0.0854, -2.9663, -0.2215, -1.5707, -1.1499,\n    -2.9609, -0.4465, -2.2003, -2.2913, -1.6215, -1.1309,\n    -1.4704, -1.3995, -1.3884, -0.0660, -0.1650, -2.1308,\n    -3.2031, -3.9345, -2.1764, 1.3080, -1.9546, -1.7681,\n    -0.2312, -0.9715, -2.6534, -2.4883, -2.4654, -1.8767,\n    -1.0560, -3.0475, -1.4475, -0.0381, -2.1643, -3.0768,\n    -2.1793, -2.3023, -0.6128, -1.2185, 0.1559, -2.7161,\n    -3.5432, -0.0345, -2.2384, -0.4120, 1.1565, -1.2185,\n    -0.4016, -0.3958, -1.4984, 0.0366, -1.5005, -0.1983,\n    -1.4674, -2.1386, -1.7766, -1.2223, -3.0039, -2.6416,\n    -0.0505, -2.6896, -4.1755, -1.3533, -0.2319, -0.8122,\n    -1.6251, -0.7554, -1.0851, -2.5855, -2.7483, -1.4720,\n    -2.9157, -2.0722, -3.0335, -2.3364, -2.8530, -2.2858,\n    -1.4284, -0.0153, -2.9818, -3.2201, -0.1989, -2.6644,\n    -0.6974, 0.8879, 0.7061, 0.5518, -1.9961, -1.1444,\n    -0.5487, -3.5222, -0.9200, -2.1158, -1.0543, -0.2796,\n    -2.2906, -1.5173, -1.5593, -1.8624\n  )\n)\n}\n\n\nuk_states &lt;- ne_states(country = \"united kingdom\", returnclass = \"sf\")\n\n# Filter for England and Wales and group by regions\nengland_wales_regions &lt;- uk_states %&gt;%\n  filter(geonunit %in% c(\"England\", \"Wales\")) %&gt;%\n  group_by(region) %&gt;%\n  summarise(geometry = st_union(geometry))\n\n\n\n\n# Check the regions\nunique(england_wales_regions$region)\n\n\n [1] \"East\"                       \"East Midlands\"             \n [3] \"East Wales\"                 \"Greater London\"            \n [5] \"North East\"                 \"North West\"                \n [7] \"South East\"                 \"South West\"                \n [9] \"West Midlands\"              \"West Wales and the Valleys\"\n[11] \"Yorkshire and the Humber\"  \n\n\nCode\nengland_wales_regions &lt;- uk_states %&gt;%\n  filter(geonunit %in% c(\"England\", \"Wales\")) %&gt;%\n  group_by(region) %&gt;%\n  summarise(geometry = st_union(geometry))\n\npos &lt;- position_jitter(width = 0.3, seed = 2)\n\npremier_league_teams &lt;- unique(filter(Data_England, Div==\"E0\" & Season==\"2024/2025\")$HomeTeam)\n\nggplot() +\n  geom_sf(data = england_wales_regions,aes(fill=region), \n          color = \"white\", linewidth = 0.3) +\n  geom_point(data = stadiums, aes(x = lon, y = lat), color = \"black\", size = 1.5, alpha = .5) +\n  geom_label_repel(data = stadiums %&gt;% filter(team %in% premier_league_teams),\n                   aes(x = lon, y = lat, label = team),  \n                   min.segment.length = 0, seed = 42, max.overlaps = 30,\n                   size=2.5) +\n  coord_sf(xlim = c(-6, 2), ylim = c(50, 56)) +\n  labs(title=\"Location of English football clubs Stadiums\",\n       fill=\"Region\",\n       caption=\"Labels only of clubs competing in Premier League during season 2024/2025\")+\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nTo Do: Add number of teams per region. (?)\n\n\n5 Team performance by league over the years\n\n\nCode\ncalculate_points &lt;- function(full_time_result, is_home_team) {\n  case_when(\n    full_time_result == \"H\" & is_home_team ~ 3,\n    full_time_result == \"A\" & !is_home_team ~ 3,\n    full_time_result == \"D\" ~ 1,\n    TRUE ~ 0\n  )\n}\n\n\n# 2. CALCULATE LEAGUE STANDINGS\n# Home results\nhome_results &lt;- Data_England %&gt;%\n  select(Season, Div, HomeTeam, FTHG, FTAG, FTR,Tier) %&gt;%\n  rename(Team = HomeTeam, GoalsFor = FTHG, GoalsAgainst = FTAG) %&gt;%\n  mutate(\n    Points = calculate_points(FTR, TRUE),\n    Venue = \"Home\"\n  )\n\n# Away results\naway_results &lt;- Data_England %&gt;%\n  select(Season, Div, AwayTeam, FTHG, FTAG, FTR,Tier) %&gt;%\n  rename(Team = AwayTeam, GoalsFor = FTAG, GoalsAgainst = FTHG) %&gt;%\n  mutate(\n    Points = calculate_points(FTR, FALSE),\n    Venue = \"Away\"\n  )\n\n# Combine and calculate standings\nall_results &lt;- bind_rows(home_results, away_results)\n\nseason_standings &lt;- all_results %&gt;%\n  group_by(Season, Div, Team,Tier) %&gt;%\n  summarise(\n    Played = n(),\n    Wins = sum(Points == 3),\n    Draws = sum(Points == 1),\n    Losses = sum(Points == 0),\n    GoalsFor = sum(GoalsFor),\n    GoalsAgainst = sum(GoalsAgainst),\n    GoalDifference = GoalsFor - GoalsAgainst,\n    Points = sum(Points),\n    .groups = 'drop'\n  ) %&gt;%\n  group_by(Season, Div) %&gt;%\n  mutate(\n    Position = rank(desc(Points), ties.method = \"first\")\n  ) %&gt;%\n  arrange(Season, Div, Position)\n\n\ntitles_data=season_standings |&gt;\n  filter(Div==\"E0\" &Position==1) |&gt;\n  group_by(Team) |&gt;\n  summarise(Titles=n())\n\n# Merge titles data with seasons data\n\n# Create the plot with highlighted Tier 1 teams\n\nmost_recent_season &lt;- max(Data_England$Season, na.rm = TRUE)\ncurrent_tier1_teams &lt;- Data_England %&gt;%\n  filter(Div == \"E0\" & Season == most_recent_season) %&gt;%\n  distinct(HomeTeam) %&gt;%\n  pull(HomeTeam)\n\nData_Teams &lt;- Data_England |&gt;\n  filter(Div == \"E0\") |&gt;\n  group_by(HomeTeam) |&gt;\n  summarize(Seasons = n_distinct(Season)) |&gt;\n  mutate(\n    # Identify if team is currently in Tier 1\n    Current_Tier1 = HomeTeam %in% current_tier1_teams,\n    # Create fill color based on Tier 1 status\n    Team_Type = ifelse(Current_Tier1, \"Current Tier 1\", \"Other Teams\")\n  )\n\n\nData_Teams_Enhanced &lt;- Data_Teams |&gt;\n  left_join(titles_data, by = c(\"HomeTeam\" = \"Team\")) |&gt;\n  mutate(\n    Titles = replace_na(Titles, 0),\n    Current_Tier1 = HomeTeam %in% current_tier1_teams,\n    Team_Type = ifelse(Current_Tier1, \"Premier League\", \"Lower Tiers\")\n  )\n\n\n# Plot with titles in labels\nData_Teams_Enhanced %&gt;%\n  mutate(HomeTeam = fct_reorder(HomeTeam, Seasons)) %&gt;%\n  ggplot(aes(x = HomeTeam, y = Seasons, fill = Team_Type)) +\n  geom_col() +\n  geom_col(aes(x = HomeTeam, y = Titles),fill=\"gold3\")+\n  geom_text(aes(label = ifelse(Titles &gt; 0, \n                               paste0(\"Titles: \", Titles),\"\"\n  )),\n  # y = 0.5,  # Position at the start of the bar\n  hjust = 0, size = 3.5, color = \"black\",fontface = \"bold\") +\n  coord_flip() +\n  labs(\n    title = \"Premier League Seasons and Titles\",\n    x = \"Team\",\n    y = \"Seasons\",\n    fill = \"\",\n    caption=\"\"\n  ) +\n  scale_fill_manual(\n    values = c(\"Premier League\" = \"steelblue\", \"Lower Tiers\" = \"lightsteelblue\")\n  ) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +\n  theme_minimal(base_size = 13) +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\nA typical league is very competitive, besides fighting for be champion, teams also can try to get into european competitions or avoid relegation.\n\n\nCode\n# Alluvial of the standigns of each league over the last years.\n\n\ntarget_season &lt;- \"2023/2024\"\n\nprem_season &lt;- premier_full_complete |&gt;\n  filter(Season == target_season)\n\nprem_season &lt;- prem_season |&gt;\n  mutate(Date = as.Date(Date))\n\nresults_long &lt;- bind_rows(\n  prem_season |&gt;\n    transmute(\n      Date,\n      Team = HomeTeam,\n      Opp  = AwayTeam,\n      GF   = FTHG,\n      GA   = FTAG\n    ),\n  prem_season |&gt;\n    transmute(\n      Date,\n      Team = AwayTeam,\n      Opp  = HomeTeam,\n      GF   = FTAG,\n      GA   = FTHG\n    )\n) |&gt;\n  arrange(Date, Team) |&gt;\n  mutate(\n    Points = case_when(\n      GF &gt; GA ~ 3L,\n      GF == GA ~ 1L,\n      TRUE    ~ 0L\n    ),\n    GD = GF - GA\n  )\n\nresults_cum &lt;- results_long |&gt;\n  group_by(Team) |&gt;\n  arrange(Date, .by_group = TRUE) |&gt;\n  mutate(\n    game_number = row_number(),       \n    cum_pts     = cumsum(Points),\n    cum_gd      = cumsum(GD),\n    cum_gf      = cumsum(GF)\n  ) |&gt;\n  ungroup()\n\n# Ranking after each game week\nstandings_by_round &lt;- results_cum |&gt;\n  group_by(game_number) |&gt;\n  arrange(\n    desc(cum_pts),\n    desc(cum_gd),\n    desc(cum_gf),\n    Team,\n    .by_group = TRUE\n  ) |&gt;\n  mutate(Position = row_number()) |&gt;\n  ungroup()\n\nmax_round &lt;- max(standings_by_round$game_number, na.rm = TRUE)\ncuts &lt;- sort(unique(c(1, seq(5, max_round, by = 5), max_round)))\n\nalluvial_df &lt;- standings_by_round |&gt;\n  filter(game_number %in% cuts) |&gt;\n  mutate(\n    Matchday  = factor(game_number, levels = cuts),\n    PosFactor = factor(Position, levels = 1:20)\n  )\n\nggplot(\n  alluvial_df,\n  aes(x = Matchday,\n      stratum  = PosFactor,\n      alluvium = Team,\n      y        = 1,\n      fill     = Team)\n) +\n  geom_flow(\n    stat          = \"alluvium\",\n    lode.guidance = \"frontback\",\n    alpha         = 0.65\n  ) +\n  geom_stratum(width = 0.25, color = \"grey30\") +\n  stat_stratum(\n    geom  = \"text\",\n    aes(label = after_stat(stratum)),\n    size  = 3,\n    color = \"black\"\n  ) +\n  guides(fill = \"none\") +  \n\n  # Names of the teams after the last round\n  geom_text(\n    stat = \"alluvium\",\n    data = dplyr::filter(\n      alluvial_df,\n      Matchday == levels(Matchday)[length(levels(Matchday))]\n    ),\n    aes(label = Team),\n    size      = 3,\n    color     = \"black\",\n    hjust     = -0.05,\n    position  = position_nudge(x = 0.2)\n  ) +\n  scale_x_discrete(expand = expansion(mult = c(0.02, 0.20))) +\n  labs(\n    title    = \"Team Positions Over the Season (Alluvial)\",\n    subtitle = paste(\n      \"Premier League\", target_season,\n      \"— positions shown every 5 matchdays\"\n    ),\n    x        = \"Matchday\",\n    y        = \"Number of teams\",\n    caption  = \"Source: football-data.co.uk | EDAV Final Project\"\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor   = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Teams in the last season, where were they in the last seasons?\n\n\n## Definition of standings_final\nseason_sizes &lt;- premier_full |&gt;\n  count(Season, name = \"n_matches\")\n\ncomplete_seasons &lt;- season_sizes |&gt;\n  filter(n_matches == 380) |&gt;\n  pull(Season)\n\npremier_complete &lt;- premier_full |&gt;\n  filter(Season %in% complete_seasons)\n\nseasons_sel &lt;- c(\"2000/2001\", \"2005/2006\", \"2010/2011\",\n                 \"2015/2016\", \"2020/2021\", \"2023/2024\")\n\npremier_sel &lt;- premier_complete |&gt;\n  filter(Season %in% seasons_sel)\n\nresults_long &lt;- bind_rows(\n  premier_sel |&gt;\n    transmute(Season,\n              Team = HomeTeam,\n              GF = FTHG,\n              GA = FTAG),\n  premier_sel |&gt;\n    transmute(Season,\n              Team = AwayTeam,\n              GF = FTAG,\n              GA = FTHG)\n) |&gt;\n  mutate(\n    Points = case_when(\n      GF &gt; GA ~ 3L,\n      GF == GA ~ 1L,\n      TRUE    ~ 0L\n    ),\n    GD = GF - GA\n  )\n\nstandings_final &lt;- results_long |&gt;\n  group_by(Season, Team) |&gt;\n  summarise(\n    points = sum(Points, na.rm = TRUE),\n    gd     = sum(GD,     na.rm = TRUE),\n    gf     = sum(GF,     na.rm = TRUE),\n    .groups = \"drop\"\n  ) |&gt;\n  group_by(Season) |&gt;\n  arrange(Season,\n          desc(points), desc(gd), desc(gf), Team,\n          .by_group = TRUE) |&gt;\n  mutate(Position = row_number()) |&gt;\n  ungroup()\n\nteams_first_season &lt;- standings_final |&gt;\n  filter(Season == \"2000/2001\") |&gt;\n  pull(Team)\n\nstandings_first &lt;- standings_final |&gt;\n  filter(Team %in% teams_first_season) |&gt;\n  mutate(\n    Season = factor(Season, levels = seasons_sel),\n    PosFactor = factor(Position, levels = 20:1)\n  )\n\nggplot(\n  standings_first,\n  aes(x = Season,\n      stratum  = PosFactor,\n      alluvium = Team,\n      y        = 1,\n      fill     = Team)\n) +\n  geom_flow(stat = \"alluvium\",\n            lode.guidance = \"frontback\",\n            alpha = 0.65) +\n  geom_stratum(width = 0.25, color = \"grey30\") +\n  stat_stratum(geom = \"text\",\n               aes(label = after_stat(stratum)),\n               size = 3, color = \"black\") +\n  guides(fill = \"none\") +\n  geom_text(\n    stat = \"alluvium\",\n    data = standings_first |&gt;\n      filter(Season == seasons_sel[1]),\n    aes(label = Team),\n    size = 3, color = \"black\", hjust = 1.05,\n    position = position_nudge(x = -0.2)\n  ) +\n  scale_x_discrete(expand = expansion(mult = c(0.20, 0.02))) +\n  scale_y_reverse(breaks = NULL) +\n  labs(\n    title    = \"Evolution of 2000/2001 Teams\",\n    subtitle = \"Premier League — Where did the early 2000s teams end up?\",\n    x        = \"Season\",\n    y        = NULL,\n    caption  = \"Source: football-data.co.uk | EDAV Final Project\"\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor   = element_blank(),\n    axis.text.y = element_blank()\n  )\n\n\n\n\n\n\n\n\n\nis this graph repeated?\n\n\nCode\n# Teams in the season 2000/2001: where are they in the current season?\n# Equipos que aparecen en 2000/2001\n\n\nteams_first_season &lt;- standings_final |&gt;\n  filter(Season == \"2000/2001\") |&gt;\n  pull(Team)\n\nstandings_first &lt;- standings_final |&gt;\n  filter(Team %in% teams_first_season) |&gt;\n  mutate(\n    Season = factor(Season, levels = seasons_sel),\n    PosFactor = factor(Position, levels = 20:1)\n  )\n\n# Gráfica\nggplot(\n  standings_first,\n  aes(x = Season,\n      stratum  = PosFactor,\n      alluvium = Team,\n      y        = 1,\n      fill     = Team)\n) +\n  geom_flow(stat = \"alluvium\",\n            lode.guidance = \"frontback\",\n            alpha = 0.65) +\n  geom_stratum(width = 0.25, color = \"grey30\") +\n  stat_stratum(geom = \"text\",\n               aes(label = after_stat(stratum)),\n               size = 3, color = \"black\") +\n  guides(fill = \"none\") +\n  # Etiquetas en la PRIMERA temporada (lado izquierdo)\n  geom_text(\n    stat = \"alluvium\",\n    data = standings_first |&gt;\n      filter(Season == seasons_sel[1]),  # Primera temporada\n    aes(label = Team),\n    size = 3, color = \"black\", hjust = 1.05,  # hjust &gt; 1 para ponerlo a la izquierda\n    position = position_nudge(x = -0.2)  # Nudge negativo para mover a la izquierda\n  ) +\n  scale_x_discrete(expand = expansion(mult = c(0.20, 0.02))) +  # Más espacio a la izquierda\n  scale_y_reverse(breaks = NULL) +\n  labs(\n    title    = \"Evolution of 2000/2001 Teams\",\n    subtitle = \"Premier League — Where did the early 2000s teams end up?\",\n    x        = \"Season\",\n    y        = NULL,\n    caption  = \"Source: football-data.co.uk | EDAV Final Project\"\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor   = element_blank(),\n    axis.text.y = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n\n\n6 Relation among numeric variables\nWe would like to conduct and analysis to examine the relationships among the different numeric variables in the dataset, for example: the number of goals, (home/away), shots, corners, offsides, total card points (yellow + red), win odds, and draw odds.\n\n\nCode\n#premier_full_complete |&gt;\n#  group_by(Season) |&gt;\n#  summarise(\n#    shots_missing = sum(is.na(HS) | is.na(AS)),\n#    shots_on_target_missing = sum(is.na(HST) | is.na(AST))\n#  ) |&gt;\n#  arrange(shots_missing)\n\npremier_full_complete &lt;- premier_full |&gt;\n  group_by(Season) |&gt;\n  filter(n() == 380) |&gt;\n  ungroup()\n\nteam_stats &lt;- bind_rows(\n  # Partidos como LOCAL\n  premier_full_complete |&gt;\n    transmute(\n      Season,\n      Team   = HomeTeam,\n      GF     = FTHG,\n      GA     = FTAG,\n      ShotsFor  = HS,\n      ShotsAg   = AS,\n      SOTFor    = HST,\n      SOTAg     = AST\n    ),\n  # Partidos como VISITANTE\n  premier_full_complete |&gt;\n    transmute(\n      Season,\n      Team   = AwayTeam,\n      GF     = FTAG,\n      GA     = FTHG,\n      ShotsFor  = AS,\n      ShotsAg   = HS,\n      SOTFor    = AST,\n      SOTAg     = HST\n    )\n) |&gt;\n  group_by(Season, Team) |&gt;\n  summarise(\n    matches                  = n(),\n    goals_for                = sum(GF,        na.rm = TRUE),\n    goals_against            = sum(GA,        na.rm = TRUE),\n    shots_for                = sum(ShotsFor,  na.rm = TRUE),\n    shots_against            = sum(ShotsAg,   na.rm = TRUE),\n    shots_on_target_for      = sum(SOTFor,    na.rm = TRUE),\n    shots_on_target_against  = sum(SOTAg,     na.rm = TRUE),\n    .groups = \"drop\"\n  )\n\n# Table with goals and shots for each team by season\nseasons_focus &lt;- c(\"2000/2001\", \"2009/2010\", \"2023/2024\")\n\nteam_stats_focus &lt;- team_stats |&gt;\n  filter(Season %in% seasons_focus) |&gt;\n  mutate(\n    Season = factor(Season, levels = seasons_focus)\n  )\n\n# 2. Parallel coordinates plot\nggparcoord(\n  data        = team_stats_focus,\n  columns     = match(\n    c(\"goals_for\",\n      \"goals_against\",\n      \"shots_on_target_for\",\n      \"shots_on_target_against\"),\n    names(team_stats_focus)\n  ),\n  groupColumn = \"Season\",\n  scale       = \"globalminmax\",  # todos los ejes entre 0 y 1\n  alphaLines  = 0.6,\n  showPoints  = TRUE\n) +\n  labs(\n    title = \"Team Profiles Across Seasons — Premier League\",\n    subtitle = \"Parallel coordinates for seasons 2000/2001, 2009/2010 and 2023/2024\",\n    x = \"Metric\",\n    y = \"Scaled value\"\n  ) +\n  theme_minimal(base_size = 11) +\n  theme(\n    plot.title = element_text(size = 14, face = \"bold\"),\n    legend.position = \"bottom\"\n  )\n\n\n\n\n\n\n\n\n\n\n\nCode\n# 1. Temporadas que queremos comparar\nseasons_focus &lt;- c(\"2000/2001\", \"2009/2010\", \"2023/2024\")\n\nteam_stats_focus &lt;- team_stats |&gt;\n  filter(Season %in% seasons_focus) |&gt;\n  mutate(\n    Season = factor(Season, levels = seasons_focus)\n  )\n\n# 2. Reescalar métricas a [0,1] (min–max global)\nteam_stats_scaled &lt;- team_stats_focus |&gt;\n  mutate(\n    goals_for_s               = rescale(goals_for),\n    goals_against_s           = rescale(goals_against),\n    shots_on_target_for_s     = rescale(shots_on_target_for),\n    shots_on_target_against_s = rescale(shots_on_target_against)\n  )\n\n# 3. Parallel coordinates con métricas escaladas\nGGally::ggparcoord(\n  data        = team_stats_scaled,\n  columns     = match(\n    c(\"goals_for_s\",\n      \"goals_against_s\",\n      \"shots_on_target_for_s\",\n      \"shots_on_target_against_s\"),\n    names(team_stats_scaled)\n  ),\n  groupColumn = \"Season\",\n  scale       = \"globalminmax\",   # ya están en [0,1], esto no cambia nada\n  alphaLines  = 0.6,\n  showPoints  = TRUE\n) +\n  labs(\n    title = \"Team Profiles Across Seasons — Premier League\",\n    subtitle = \"Metrics rescaled to [0,1] for seasons 2000/2001, 2009/2010 and 2023/2024\",\n    x = \"Metric\",\n    y = \"Scaled value\"\n  ) +\n  theme_minimal(base_size = 11) +\n  theme(\n    plot.title = element_text(size = 14, face = \"bold\"),\n    legend.position = \"bottom\"\n  )\n\n\n\n\n\n\n\n\n\n\n\n7 Relation among categorical variables\nWe want to analyze the existing categorical data and create additional categorical variables to better understand the relationships between team results and certain classifications. We would also like to explore the behavior of different teams, for example, how many home teams that were losing a match ended up winning it, or which leagues are more “home-biased” (meaning that home teams win most of the matches).\nTo do. Clean up a bit\n\n\nCode\nData_England_Time=Data_England |&gt;\n  filter(is.na(Time)==F)\n# Convert Time to proper time format\n\nData_England_Time$Time &lt;- as.POSIXct(Data_England_Time$Time, format = \"%H:%M:%S\")\n\n# Extract hour for grouping\nData_England_Time$Hour &lt;- as.numeric(format(Data_England_Time$Time, \"%H\"))\nData_England_Time$Minute &lt;- as.numeric(format(Data_England_Time$Time, \"%M\"))\n# Convert Date to proper format and extract day of week\nData_England_Time$Date &lt;- as.Date(Data_England_Time$Date)\nData_England_Time$DayOfWeek &lt;- weekdays(Data_England_Time$Date)\nData_England_Time$IsWeekend &lt;- Data_England_Time$DayOfWeek %in% c(\"Saturday\", \"Sunday\")\n\n\n\n\n# Extract hour from Time column\nData_England$Hour &lt;- as.numeric(format(as.POSIXct(Data_England$Time, format = \"%H:%M:%S\"), \"%H\"))\n\nsort(unique(Data_England_Time$Hour))\n\n\n[1] 12 13 14 15 16 17 18 19 20\n\n\nCode\n# Basic histogram\nggplot(Data_England_Time, aes(x = Hour)) +\n  geom_bar() +\n  labs(\n    title = \"Distribution of Match Starting Times\",\n    subtitle = \"Histogram of kick-off hours\",\n    x = \"Starting Hour\",\n    y = \"Number of Matches\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nCode\n# Create time categories\nData_England_Time$Time_Category &lt;- cut(Data_England_Time$Hour,\n                              breaks = c(0, 14, 18, 21),\n                              labels = c(\"Morning\", \"Afternoon\", \"Evening\"),\n                              include.lowest = TRUE)\n\n# Analyze match outcomes by time of day\ntime_analysis &lt;- Data_England_Time %&gt;%\n  group_by(Time_Category) %&gt;%\n  summarise(\n    Total_Matches = n(),\n    Home_Wins = sum(FTR == \"H\", na.rm = TRUE),\n    Away_Wins = sum(FTR == \"A\", na.rm = TRUE),\n    Draws = sum(FTR == \"D\", na.rm = TRUE)\n  )\n\n# Goals scored by time of day\ngoals_by_time &lt;- Data_England_Time %&gt;%\n  group_by(Hour) %&gt;%\n  summarise(\n    Avg_Home_Goals = mean(FTHG, na.rm = TRUE),\n    Avg_Away_Goals = mean(FTAG, na.rm = TRUE),\n    Total_Goals=mean(FTHG+FTAG,na.rm=TRUE),\n    Matches = n()\n  )\n\n# Discipline by time\ncards_by_time &lt;- Data_England_Time %&gt;%\n  group_by(Hour) %&gt;%\n  summarise(\n    Avg_Yellow_Cards = mean(HY + AY, na.rm = TRUE),\n    Avg_Red_Cards = mean(HR + AR, na.rm = TRUE)\n  )\n\n\n\n# Combine with time analysis\nweekend_time_analysis &lt;- Data_England_Time %&gt;%\n  group_by(IsWeekend, Time_Category) %&gt;%\n  summarise(\n    Matches = n(),\n    Avg_Goals = mean(FTHG + FTAG, na.rm = TRUE),\n    Home_Win_Rate = mean(FTR == \"H\", na.rm = TRUE)\n  )\n\n\n`summarise()` has grouped output by 'IsWeekend'. You can override using the\n`.groups` argument.\n\n\nCode\n# Home team performance by kick-off time\nhome_team_time &lt;- Data_England_Time %&gt;%\n  group_by(HomeTeam, Time_Category) %&gt;%\n  summarise(\n    Matches = n(),\n    Wins = sum(FTR == \"H\"),\n    Goals_Scored = mean(FTHG),\n    Goals_Conceded = mean(FTAG),\n    Win_Rate = mean(FTR == \"H\")\n  ) %&gt;%\n  arrange(desc(Win_Rate))\n\n\n`summarise()` has grouped output by 'HomeTeam'. You can override using the\n`.groups` argument.\n\n\nCode\n# Away team performance by kick-off time\naway_team_time &lt;- Data_England_Time %&gt;%\n  group_by(AwayTeam, Time_Category) %&gt;%\n  summarise(\n    Matches = n(),\n    Wins = sum(FTR == \"A\"),\n    Goals_Scored = mean(FTAG),\n    Goals_Conceded = mean(FTHG),\n    Win_Rate = mean(FTR == \"A\")\n  )\n\n\n`summarise()` has grouped output by 'AwayTeam'. You can override using the\n`.groups` argument.\n\n\nCode\n# Goals by hour of day\nggplot(goals_by_time, aes(x = Hour, y = Total_Goals)) +\n  geom_line() +\n  geom_point() +\n  labs(title = \"Average Goals by Kick-off Time\", \n       x = \"Hour of Day\", y = \"Average Goals per Match\")\n\n\n\n\n\n\n\n\n\nCode\n# Match outcomes by time category\nggplot(time_analysis, aes(x = Time_Category, y = Home_Wins/Total_Matches)) +\n  geom_col() +\n  labs(title = \"Home Win Rate by Time of Day\", \n       x = \"Time Category\", y = \"Home Win Rate\")\n\n\n\n\n\n\n\n\n\nCode\n# Create goal difference categories\nData_England_Time$Goal_Diff &lt;- Data_England_Time$FTHG - Data_England_Time$FTAG\nData_England_Time$Result_Type &lt;- ifelse(Data_England_Time$Goal_Diff &gt; 2, \"Big Home Win\",\n                               ifelse(Data_England_Time$Goal_Diff &gt; 0, \"Close Home Win\",\n                                      ifelse(Data_England_Time$Goal_Diff == 0, \"Draw\",\n                                             ifelse(Data_England_Time$Goal_Diff &lt; -2, \"Big Away Win\", \"Close Away Win\"))))\n\nmosaicplot(~ Time_Category + Result_Type, data = Data_England_Time,\n           main = \"Match Types by Time of Day\",\n           xlab = \"Time Category\", \n           ylab = \"Result Type\",\n           color = c(\"darkred\", \"red\", \"gray\", \"blue\", \"darkblue\"))\n\n\n\n\n\n\n\n\n\nCode\n# For more complex relationships (using vcd package)\n# Extract day of week\nData_England_Time$DayOfWeek &lt;- weekdays(as.Date(Data_England_Time$Date))\nData_England_Time$DayType &lt;- ifelse(Data_England_Time$DayOfWeek %in% c(\"Saturday\", \"Sunday\"), \n                           \"Weekend\", \"Weekday\")\n\nmosaicplot(~ Time_Category + DayType, data = Data_England_Time,\n           main = \"Match Results: Weekend vs Weekday\",\n           xlab = \"Day Type\", \n           ylab = \"Full Time Result\",\n           color = c(\"#FF6B6B\", \"#4ECDC4\", \"#45B7D1\"))\n\n\n\n\n\n\n\n\n\nCode\n# Result by Time and Day Type\nstructable(FTR ~ Time_Category + DayType+Div, data = Data_England_Time)\n\n\n                          FTR   A   D   H\nTime_Category DayType Div                \nMorning       Weekday E0      124  88 149\n                      E1       94  87 112\n                      E2       38  26  64\n                      E3       33  37  50\n              Weekend E0       54  32  65\n                      E1       44  29  53\n                      E2       18  18  22\n                      E3       13   8  20\nAfternoon     Weekday E0      276 201 355\n                      E1      400 320 571\n                      E2      470 383 630\n                      E3      465 425 670\n              Weekend E0      122  87 157\n                      E1      155 149 247\n                      E2      201 163 283\n                      E3      224 181 301\nEvening       Weekday E0      130  91 197\n                      E1      231 197 326\n                      E2      207 149 258\n                      E3      160 168 230\n              Weekend E0       56  26  70\n                      E1       98  79 120\n                      E2       62  57 111\n                      E3       73  66  76\n\n\nCode\nmosaic(~ Time_Category + DayType +Div+ FTR, data = Data_England_Time,\n       main = \"Results by Time and Day Type\",\n       labeling_args = list(rot_labels = c(20, 0, 0, 0)),\n       highlighting = \"FTR\",\n       highlighting_fill = c(\"red\", \"gray\", \"blue\"))\n\n\n\n\n\n\n\n\n\nCode\n# Simple binary/categorical versions of your variables\n# Similar to the (No/Yes) format in your image\n\n# Create binary variables from your data\nData_England_Time$High_Goals &lt;- ifelse(Data_England_Time$FTHG + Data_England_Time$FTAG &gt; 2.5, \"Yes\", \"No\")\nData_England_Time$Home_Advantage &lt;- ifelse(Data_England_Time$FTHG &gt; Data_England_Time$FTAG, \"Yes\", \"No\")\nData_England_Time$Many_Cards &lt;- ifelse(Data_England_Time$HY + Data_England_Time$AY &gt; 3.5, \"Yes\", \"No\")\nData_England_Time$Many_Shots &lt;- ifelse(Data_England_Time$HS + Data_England_Time$AS &gt; 25, \"Yes\", \"No\")\nData_England_Time$Weekend &lt;- ifelse(weekdays(as.Date(Data_England_Time$Date)) %in% c(\"Saturday\", \"Sunday\"), \"Yes\", \"No\")\n\n\n# Simple 2x2 mosaic plot\nmosaicplot(~ Home_Advantage + Weekend, data = Data_England_Time,\n           main = \"Home Wins vs Weekend Matches\",\n           xlab = \"Home Win\", \n           ylab = \"Weekend Match\",\n           color = c(\"lightblue\", \"salmon\"))\n\n\n\n\n\n\n\n\n\nCode\n# Create a structured plot similar to your image\npar(mfrow = c(2, 2))  # 2x2 grid of plots\n\n# Plot 1: Goals vs Weekend\nmosaicplot(~ High_Goals + Weekend, data = Data_England_Time,\n           main = \"High Scoring vs Weekend\",\n           color = c(\"#E7B800\", \"#2E9FDF\"))\n\n# Plot 2: Cards vs Home Advantage\nmosaicplot(~ Many_Cards + Home_Advantage, data = Data_England_Time,\n           main = \"Many Cards vs Home Wins\",\n           color = c(\"#E7B800\", \"#2E9FDF\"))\n\n# Plot 3: Shots vs Home Advantage\nmosaicplot(~ Many_Shots + Home_Advantage, data = Data_England_Time,\n           main = \"Many Shots vs Home Wins\",\n           color = c(\"#E7B800\", \"#2E9FDF\"))\n\n# Plot 4: Goals vs Many Cards\nmosaicplot(~ High_Goals + Many_Cards, data = Data_England_Time,\n           main = \"High Scoring vs Many Cards\",\n           color = c(\"#E7B800\", \"#2E9FDF\"))\n\n\n\n\n\n\n\n\n\nCode\npar(mfrow = c(1, 1))  # Reset plot layout\n\n\n# Convert time to binary categories\nData_England_Time$Prime_Time &lt;- ifelse(Data_England_Time$Hour %in% c(17, 18, 19, 20), \"Yes\", \"No\")\nData_England_Time$Afternoon &lt;- ifelse(Data_England_Time$Hour %in% c(12, 13, 14, 15), \"Yes\", \"No\")\n\n# Create mosaic plots with time variables\nmosaicplot(~ Home_Advantage + Prime_Time, data = Data_England_Time,\n           main = \"Home Wins vs Prime Time Matches\",\n           xlab = \"Home Win\", \n           ylab = \"Prime Time (5-8 PM)\",\n           color = c(\"lightgreen\", \"orange\"))\n\n\n\n\n\n\n\n\n\nCode\nmosaicplot(~ High_Goals + Afternoon, data = Data_England_Time,\n           main = \"High Scoring vs Afternoon Matches\",\n           xlab = \"High Goals (&gt;2.5)\", \n           ylab = \"Afternoon Match\",\n           color = c(\"lightblue\", \"pink\"))\n\n\n\n\n\n\n\n\n\nCode\n# More polished version similar to academic papers\nmosaic(~Prime_Time+Home_Advantage + Weekend + Many_Cards, \n       data = Data_England_Time,\n       main = \"Football Match Analysis\",\n       labeling_args = list(\n         set_varnames = c(Home_Advantage = \"Home Win\", \n                          Weekend = \"Weekend Match\", \n                          Many_Cards = \"High Cards\"),\n         rot_labels = c(20, 0, 0, 0)\n       ),\n       highlighting = \"Home_Advantage\",\n       highlighting_fill = c(\"lightblue\", \"coral\"))\n\n\n\n\n\n\n\n\n\nCode\n###\n\n\n\n\n8 Detection of clusters\nWe know that many of the numerical variables in our dataset are related, so within each league we would like to identify clusters of teams that share similar behavior across seasons. Based on these clusters, we could create indexes and provide explanations for the patterns observed.\n\n\nCode\n# Create team-level aggregated data\nmost_recent_season &lt;- max(Data_England$Season, na.rm = TRUE)\n\ncurrent_tier1_teams &lt;- Data_England %&gt;%\n  filter(Div == \"E0\" & Season ==most_recent_season ) %&gt;%\n  distinct(HomeTeam) %&gt;%\n  pull(HomeTeam)\n\n\nteam_performance &lt;- Data_England |&gt;\n  # Home performances\n  select(Season, Team = HomeTeam, \n         Goals_For = FTHG, Goals_Against = FTAG,\n         Shots = HS, Shots_Target = HST,\n         Fouls = HF, Corners = HC,\n         Yellow_Cards = HY, Red_Cards = HR,\n         Result = FTR) |&gt;\n  mutate(Venue = \"Home\") |&gt;\n  # Away performances\n  bind_rows(\n    Data_England |&gt;\n      filter(Div == \"E0\") |&gt;\n      select(Season, Team = AwayTeam,\n             Goals_For = FTAG, Goals_Against = FTHG,\n             Shots = AS, Shots_Target = AST,\n             Fouls = AF, Corners = AC,\n             Yellow_Cards = AY, Red_Cards = AR,\n             Result = FTR) |&gt;\n      mutate(Venue = \"Away\")\n  ) |&gt;\n  group_by(Team) |&gt;\n  summarise(\n    # Goal metrics\n    Avg_Goals_For = mean(Goals_For, na.rm = TRUE),\n    Avg_Goals_Against = mean(Goals_Against, na.rm = TRUE),\n    Goal_Difference = mean(Goals_For - Goals_Against, na.rm = TRUE),\n    \n    # Shooting metrics\n    Avg_Shots = mean(Shots, na.rm = TRUE),\n    Avg_Shots_Target = mean(Shots_Target, na.rm = TRUE),\n    Shot_Accuracy = ifelse(mean(Shots, na.rm = TRUE) &gt; 0,\n                           mean(Shots_Target, na.rm = TRUE) / mean(Shots, na.rm = TRUE),\n                           0),\n    \n    # Defensive metrics\n    Avg_Fouls = mean(Fouls, na.rm = TRUE),\n    Avg_Corners = mean(Corners, na.rm = TRUE),\n    \n    # Discipline metrics\n    Avg_Yellow_Cards = mean(Yellow_Cards, na.rm = TRUE),\n    Avg_Red_Cards = mean(Red_Cards, na.rm = TRUE),\n    \n    # WIN COUNTS - NEW ADDITIONS\n    Home_Wins = sum(Venue == \"Home\" & Result == \"H\", na.rm = TRUE),\n    Away_Wins = sum(Venue == \"Away\" & Result == \"A\", na.rm = TRUE),\n    Total_Wins = sum((Venue == \"Home\" & Result == \"H\") | (Venue == \"Away\" & Result == \"A\"), na.rm = TRUE),\n    \n    # Performance metrics\n    Win_Rate = Total_Wins / n(),\n    Draw_Rate = sum(Result == \"D\", na.rm = TRUE) / n(),\n    Loss_Rate = sum((Venue == \"Home\" & Result == \"A\") | (Venue == \"Away\" & Result == \"H\"), na.rm = TRUE) / n(),\n    \n    # Home/Away specific rates\n    Home_Win_Rate = Home_Wins / sum(Venue == \"Home\"),\n    Away_Win_Rate = Away_Wins / sum(Venue == \"Away\"),\n    \n    # Venue metrics\n    Home_Matches = sum(Venue == \"Home\"),\n    Away_Matches = sum(Venue == \"Away\"),\n    \n    # Sample size\n    Matches_Played = n(),\n    \n    .groups = 'drop'\n  ) |&gt;\n  filter(Matches_Played &gt;= 50)  # Only teams with sufficient data  # Only teams with sufficient data\n\n\nteam_performance=team_performance |&gt;\n  filter(Team %in% current_tier1_teams) \n# Select numeric variables for PCA\n\nteam_performance &lt;- team_performance %&gt;%\n  mutate(across(where(is.numeric), ~ ifelse(is.nan(.), 0, .)))\n\nteam_performance &lt;- team_performance %&gt;%\n  mutate_if(is.numeric, ~ifelse(is.infinite(.), 0, .))\n\n\npca_data &lt;- team_performance |&gt;\n  select(Avg_Goals_For, Avg_Goals_Against,\n         Avg_Shots, Avg_Shots_Target,\n         Avg_Fouls, Avg_Corners, Avg_Yellow_Cards, Avg_Red_Cards,\n         Draw_Rate,Home_Win_Rate,Away_Win_Rate) |&gt;\n  scale()  # Standardize the variables\n\nrownames(pca_data) &lt;- team_performance$Team\n\n\n# Perform PCA\npca_result &lt;- PCA(pca_data, graph = FALSE)\n\n# Basic biplot\nfviz_pca_biplot(pca_result, \n                repel = TRUE,\n                col.var = \"red\",\n                col.ind = \"blue\",\n                alpha.ind = 0.7,\n                title = \"Team Performance Biplot - All Variables\")\n\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\nℹ The deprecated feature was likely used in the ggpubr package.\n  Please report the issue at &lt;https://github.com/kassambara/ggpubr/issues&gt;.\n\n\n\n\n\n\n\n\n\nTo Do: Explain PCA\n\n\n9 Referee analysys, is there bias?\nWe would like to explore different ways of analyzing referees behavior during matches to determine whether referees are biased toward home teams. We also want to examine if there is any relationship between league results and World Cup outcomes. In addition, we plan to calculate the differences between the probabilities provided by betting houses and the actual outcomes, as well as conduct other complementary analyses.\nTo Do: Decide which one to get\n\n\nCode\nReferees=Data_England |&gt;\n  filter(is.na(Referee)==F )|&gt;\n  mutate(HomeWon=ifelse(FTR==\"H\",1,0),\n         AwayWon=ifelse(FTR==\"A\",1,0))|&gt;\n  group_by(\n    Referee\n  ) |&gt;\n  summarise(Count_matches=n(),\n            n_seasons=n_distinct(Season,na.rm=T),\n            n_tiers=n_distinct(Tier,na.rm=T),\n            Home_wins_count=sum(HomeWon,na.rm=T),\n            Away_wins_count=sum(AwayWon,na.rm=T))\n\nReferees=Referees |&gt;\n  filter(Count_matches&gt;=15)\n\n\n\nReferees %&gt;%\n  arrange(desc(Count_matches)) %&gt;%\n  slice_head(n = 30) %&gt;%                 # top 30\n  mutate(Referee = fct_reorder(Referee, Count_matches)) %&gt;%\n  ggplot(aes(x = Referee, y = Count_matches)) +\n  geom_segment(aes(xend = Referee, yend = 0), color = \"grey70\") +\n  geom_point(size = 3, color = \"darkgreen\") +\n  coord_flip() +\n  labs(\n    title = \"Top Referees by Match Count\",\n    x = \"Referee\",\n    y = \"Matches\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nCode\nReferees %&gt;%\n  mutate(\n    home_win_rate = Home_wins_count / Count_matches,\n    away_win_rate = Away_wins_count / Count_matches\n  ) %&gt;%\n  ggplot(aes(x = home_win_rate, y = away_win_rate, fill = Count_matches)) +\n  geom_point(alpha = 0.7, color = \"steelblue\") +\n  \n  labs(\n    title = \"Home vs Away Win Rates per Referee\",\n    x = \"Home Win Rate\",\n    y = \"Away Win Rate\",\n    size = \"Matches Refereed\"\n  ) +\n  theme_minimal()\n\n\nIgnoring unknown labels:\n• size : \"Matches Refereed\"\n\n\n\n\n\n\n\n\n\nCode\nReferees %&gt;%\n  mutate(\n    home_win_rate = Home_wins_count / Count_matches\n  ) %&gt;%\n  ggplot(aes(x = Count_matches, y = home_win_rate)) +\n  geom_point(alpha = 0.3, color = \"darkblue\") +\n  scale_y_log10()+\n  scale_x_log10()+\n  labs(\n    title = \"Do More Experienced Referees Show Less Home Bias?\",\n    x = \"Matches \",\n    y = \"Home Win Rate\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nCode\nReferees_Home_team=Data_England |&gt;\n  filter(is.na(Referee)==F)|&gt;\n  mutate(HomeWon=ifelse(FTR==\"H\",1,0),\n         AwayWon=ifelse(FTR==\"A\",1,0))|&gt;\n  group_by(\n    Referee, HomeTeam\n  ) |&gt;\n  summarise(Count_matches=n(),\n            n_seasons=n_distinct(Season,na.rm=T),\n            n_tiers=n_distinct(Tier,na.rm=T),\n            Home_wins_count=sum(HomeWon,na.rm=T),\n            Away_wins_count=sum(AwayWon,na.rm=T))\n\n\n`summarise()` has grouped output by 'Referee'. You can override using the\n`.groups` argument.\n\n\nCode\nReferees_Home_team &lt;- Referees_Home_team |&gt;\n  mutate(\n    Home_win_rate = Home_wins_count / Count_matches,\n    Total_matches = Count_matches\n  )\n\n# Filter for meaningful combinations (enough matches)\nsignificant_ref_team &lt;- Referees_Home_team |&gt;\n  filter(Total_matches &gt;= 20)  # Only consider referee-team pairs with 5+ matches\n\n# Heatmap\nggplot(significant_ref_team, aes(x = Referee, y = HomeTeam)) +\n  geom_tile(aes(fill = Home_win_rate), color = \"white\") +\n  scale_fill_gradient2(\n    low = \"blue\", mid = \"white\", high = \"red\", \n    midpoint = 0.5,  # Average home win rate\n    limits = c(0, 1),\n    name = \"Home Win Rate\"\n  ) +\n  labs(\n    title = \"Referee Home Team Win Rates\",\n    subtitle = \"Heatmap showing if referees favor certain home teams\",\n    x = \"Referee\",\n    y = \"Home Team\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 8),\n    axis.text.y = element_text(size = 7),\n    legend.position = \"bottom\"\n  )",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Enlglish football through the years</span>"
    ]
  },
  {
    "objectID": "conclusion.html",
    "href": "conclusion.html",
    "title": "4  Conclusion",
    "section": "",
    "text": "To do. Explain something like the results of our questions and stuff that was interesting.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Conclusion</span>"
    ]
  }
]